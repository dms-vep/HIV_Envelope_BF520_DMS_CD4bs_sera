
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Validation neutralization assays versus polyclonal fits &#8212; Deep mutational scanning of HIV Envelope BF520 with anti-CD4 binding site sera and antibodies  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mutation effects compared to natural sequence variation" href="mutations_vs_natural_sequences.html" />
    <link rel="prev" title="Antibody-escape averaged across replicates" href="avg_antibody_escape.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Validation-neutralization-assays-versus-polyclonal-fits">
<h1>Validation neutralization assays versus <code class="docutils literal notranslate"><span class="pre">polyclonal</span></code> fits<a class="headerlink" href="#Validation-neutralization-assays-versus-polyclonal-fits" title="Permalink to this heading">¶</a></h1>
<p>Compare actual measured neutralization values for specific mutants to the <code class="docutils literal notranslate"><span class="pre">polyclonal</span></code> fits.</p>
<p>Import Python modules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">yaml</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#999999&#39;</span><span class="p">,</span> <span class="s1">&#39;#0072B2&#39;</span><span class="p">,</span>  <span class="s1">&#39;#E69F00&#39;</span><span class="p">,</span> <span class="s1">&#39;#F0E442&#39;</span><span class="p">,</span> <span class="s1">&#39;#009E73&#39;</span><span class="p">,</span><span class="s1">&#39;#56B4E9&#39;</span><span class="p">,</span> <span class="s2">&quot;#D55E00&quot;</span><span class="p">,</span> <span class="s2">&quot;#CC79A7&quot;</span><span class="p">]</span>

<span class="n">extended_palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#999999&#39;</span><span class="p">,</span> <span class="s1">&#39;#0072B2&#39;</span><span class="p">,</span>  <span class="s1">&#39;#E69F00&#39;</span><span class="p">,</span> <span class="s1">&#39;#F0E442&#39;</span><span class="p">,</span> <span class="s1">&#39;#009E73&#39;</span><span class="p">,</span><span class="s1">&#39;#56B4E9&#39;</span><span class="p">,</span> <span class="s2">&quot;#D55E00&quot;</span><span class="p">,</span> <span class="s2">&quot;#CC79A7&quot;</span><span class="p">,</span> <span class="s1">&#39;#9F0162&#39;</span><span class="p">]</span>

<span class="n">long_palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#9F0162&#39;</span><span class="p">,</span> <span class="s1">&#39;#009F81&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF5AAF&#39;</span><span class="p">,</span> <span class="s1">&#39;#8400CD&#39;</span><span class="p">,</span> <span class="s1">&#39;#008DF9&#39;</span><span class="p">,</span> <span class="s1">&#39;#00C2F9&#39;</span><span class="p">,</span> <span class="s1">&#39;#FFB2FD&#39;</span><span class="p">,</span> <span class="s1">&#39;#A40122&#39;</span><span class="p">,</span> <span class="s1">&#39;#E20134&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF6E3A&#39;</span><span class="p">,</span> <span class="s1">&#39;#FFC33B&#39;</span><span class="p">,</span> <span class="s1">&#39;#00FCCF&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Read configuration and validation assay measurements:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">validation_ic50s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;validation_ics&quot;</span><span class="p">],</span> <span class="n">na_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">validation_ic50s</span><span class="p">[</span><span class="s1">&#39;max % neutralization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">validation_ic50s</span><span class="p">[</span><span class="s1">&#39;max % neutralization&#39;</span><span class="p">],</span> <span class="n">a_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">validation_ic50s</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antibody</th>
      <th>aa_substitutions</th>
      <th>max % neutralization</th>
      <th>measured IC50</th>
      <th>MAP_fold_enrichment</th>
      <th>measured IC90</th>
      <th>measured IC80</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PGT151</td>
      <td></td>
      <td>100</td>
      <td>0.065000</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>PGT151</td>
      <td>N611S</td>
      <td>98</td>
      <td>0.187000</td>
      <td>5.4</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>PGT151</td>
      <td>S612P</td>
      <td>81</td>
      <td>0.150000</td>
      <td>8</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>PGT151</td>
      <td>N637A</td>
      <td>81</td>
      <td>0.046000</td>
      <td>1</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>PGT151</td>
      <td>N637K</td>
      <td>59</td>
      <td>0.092000</td>
      <td>3.7</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>88</th>
      <td>3BNC117</td>
      <td>G459D</td>
      <td>100</td>
      <td>0.009945</td>
      <td></td>
      <td>0.043379</td>
      <td>0.025188</td>
    </tr>
    <tr>
      <th>89</th>
      <td>3BNC117</td>
      <td>R476M</td>
      <td>100</td>
      <td>0.002286</td>
      <td></td>
      <td>0.010977</td>
      <td>0.005776</td>
    </tr>
    <tr>
      <th>90</th>
      <td>3BNC117</td>
      <td>T202P</td>
      <td>100</td>
      <td>0.011801</td>
      <td></td>
      <td>0.086449</td>
      <td>0.041454</td>
    </tr>
    <tr>
      <th>91</th>
      <td>3BNC117</td>
      <td>N463S</td>
      <td>100</td>
      <td>0.014342</td>
      <td></td>
      <td>0.061920</td>
      <td>0.036090</td>
    </tr>
    <tr>
      <th>92</th>
      <td>3BNC117</td>
      <td>Q203P</td>
      <td>100</td>
      <td>0.004815</td>
      <td></td>
      <td>0.036248</td>
      <td>0.017207</td>
    </tr>
  </tbody>
</table>
<p>93 rows × 7 columns</p>
</div></div>
</div>
<p>Now get the predictions by the averaged <code class="docutils literal notranslate"><span class="pre">polyclonal</span></code> model fits:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">validation_vs_prediction</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">antibody</span><span class="p">,</span> <span class="n">antibody_df</span> <span class="ow">in</span> <span class="n">validation_ic50s</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;escape_dir&quot;</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2">.pickle&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">icXX</span><span class="p">(</span><span class="n">antibody_df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">icXX</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.80</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;IC80&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">model</span><span class="o">.</span><span class="n">mut_escape_df</span>
                   <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mutation&#39;</span><span class="p">:</span> <span class="s1">&#39;aa_substitutions&#39;</span><span class="p">})</span>
                   <span class="p">[[</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">,</span> <span class="s1">&#39;times_seen&#39;</span><span class="p">]]</span>
                  <span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">)</span>
    <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">validation_vs_prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">validation_vs_prediction</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">validation_vs_prediction</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antibody</th>
      <th>aa_substitutions</th>
      <th>max % neutralization</th>
      <th>measured IC50</th>
      <th>MAP_fold_enrichment</th>
      <th>measured IC90</th>
      <th>measured IC80</th>
      <th>mean_IC50</th>
      <th>median_IC50</th>
      <th>std_IC50</th>
      <th>frac_models</th>
      <th>mean_IC80</th>
      <th>median_IC80</th>
      <th>std_IC80</th>
      <th>n_models</th>
      <th>times_seen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1-18</td>
      <td></td>
      <td>100</td>
      <td>0.012082</td>
      <td></td>
      <td>0.082944</td>
      <td>0.040739</td>
      <td>0.144252</td>
      <td>0.148220</td>
      <td>0.044308</td>
      <td>1.0</td>
      <td>0.577007</td>
      <td>0.592881</td>
      <td>0.177232</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1-18</td>
      <td>G459D</td>
      <td>100</td>
      <td>0.004669</td>
      <td></td>
      <td>0.035790</td>
      <td>0.016877</td>
      <td>0.135613</td>
      <td>0.140224</td>
      <td>0.037853</td>
      <td>1.0</td>
      <td>0.542454</td>
      <td>0.560894</td>
      <td>0.151414</td>
      <td>3</td>
      <td>7.333333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1-18</td>
      <td>N276D</td>
      <td>100</td>
      <td>0.005727</td>
      <td></td>
      <td>0.014183</td>
      <td>0.007466</td>
      <td>0.121674</td>
      <td>0.120504</td>
      <td>0.029304</td>
      <td>1.0</td>
      <td>0.486695</td>
      <td>0.482017</td>
      <td>0.117215</td>
      <td>3</td>
      <td>5.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1-18</td>
      <td>N276D G459D</td>
      <td>100</td>
      <td>0.001909</td>
      <td></td>
      <td>0.007638</td>
      <td>0.004369</td>
      <td>0.114543</td>
      <td>0.114003</td>
      <td>0.024145</td>
      <td>1.0</td>
      <td>0.458171</td>
      <td>0.456012</td>
      <td>0.096579</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1-18</td>
      <td>N463S</td>
      <td>100</td>
      <td>0.018143</td>
      <td></td>
      <td>0.096897</td>
      <td>0.052213</td>
      <td>0.170993</td>
      <td>0.192584</td>
      <td>0.063642</td>
      <td>1.0</td>
      <td>0.683971</td>
      <td>0.770334</td>
      <td>0.254570</td>
      <td>3</td>
      <td>3.666667</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>86</th>
      <td>PGT151</td>
      <td>T639A</td>
      <td>78</td>
      <td>0.049000</td>
      <td>1.4</td>
      <td></td>
      <td></td>
      <td>0.117863</td>
      <td>0.133528</td>
      <td>0.034372</td>
      <td>1.0</td>
      <td>0.471453</td>
      <td>0.534112</td>
      <td>0.137489</td>
      <td>3</td>
      <td>9.333333</td>
    </tr>
    <tr>
      <th>87</th>
      <td>PGT151</td>
      <td>T639K</td>
      <td>74</td>
      <td>0.041000</td>
      <td>4.8</td>
      <td></td>
      <td></td>
      <td>0.303235</td>
      <td>0.284325</td>
      <td>0.115428</td>
      <td>1.0</td>
      <td>1.212939</td>
      <td>1.137300</td>
      <td>0.461711</td>
      <td>3</td>
      <td>8.333333</td>
    </tr>
    <tr>
      <th>88</th>
      <td>PGT151</td>
      <td>T639R</td>
      <td>79</td>
      <td>0.042000</td>
      <td>2.8</td>
      <td></td>
      <td></td>
      <td>0.122779</td>
      <td>0.133416</td>
      <td>0.041962</td>
      <td>1.0</td>
      <td>0.491115</td>
      <td>0.533666</td>
      <td>0.167848</td>
      <td>3</td>
      <td>4.333333</td>
    </tr>
    <tr>
      <th>89</th>
      <td>PGT151</td>
      <td>T644A</td>
      <td>96</td>
      <td>0.052000</td>
      <td>1</td>
      <td></td>
      <td></td>
      <td>0.111451</td>
      <td>0.125095</td>
      <td>0.030111</td>
      <td>1.0</td>
      <td>0.445805</td>
      <td>0.500381</td>
      <td>0.120443</td>
      <td>3</td>
      <td>8.666667</td>
    </tr>
    <tr>
      <th>90</th>
      <td>PGT151</td>
      <td>T644R</td>
      <td>87</td>
      <td>0.094000</td>
      <td>4</td>
      <td></td>
      <td></td>
      <td>0.280398</td>
      <td>0.318298</td>
      <td>0.188432</td>
      <td>1.0</td>
      <td>1.121591</td>
      <td>1.273192</td>
      <td>0.753728</td>
      <td>3</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
<p>91 rows × 16 columns</p>
</div></div>
</div>
<p>For each antibody, calculate the Pearson correlation coefficient between the predicted IC50s from our models and the IC50s measured in validation assays. We are doing this first for only single mutants:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Single mutant correlations between DMS predicted and neutralization assay measured IC50s/IC80s:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">antibody</span><span class="p">,</span> <span class="n">antibody_df</span> <span class="ow">in</span> <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;antibody&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">antibody</span> <span class="o">==</span> <span class="s2">&quot;PGT151&quot;</span><span class="p">:</span>
        <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;aa_substitutions!=&#39;&#39;&quot;</span><span class="p">)</span>
        <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="p">[</span><span class="o">~</span><span class="n">antibody_df</span><span class="p">[</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2"> (IC50):&quot;</span><span class="p">)</span>
        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;median_IC50&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured IC50&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PGT151 MAP_fold_enrichment correlation:&quot;</span><span class="p">)</span>
        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured IC50&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;aa_substitutions!=&#39;&#39;&quot;</span><span class="p">)</span>
        <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="p">[</span><span class="o">~</span><span class="n">antibody_df</span><span class="p">[</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;median_IC80&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured IC80&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Single mutant correlations between DMS predicted and neutralization assay measured IC50s/IC80s:
1-18:
0.186
3BNC117:
0.607
IDC508:
0.662
IDC513:
0.68
IDC561:
0.434
IDF033:
0.804
PGT151 (IC50):
0.813
PGT151 MAP_fold_enrichment correlation:
0.303
</pre></div></div>
</div>
<p>Now, plot the results. We will plot the <strong>median</strong> across the replicate polyclonal fits to different deep mutational scanning replicates. This is an interactive plot that you can mouse over for details:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody!=&quot;PGT151&quot;&#39;</span><span class="p">)</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="o">~</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
<span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;measured IC80&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;measured IC80&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">corr_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;measured IC80&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;median_IC80&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;predicted IC80 from DMS&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Amino acid substitutions&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;tableau10&quot;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">validation_vs_prediction</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">corr_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-bbc93b28591541aeb0a0d4805cad6b2a"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-bbc93b28591541aeb0a0d4805cad6b2a") {
      outputDiv = document.getElementById("altair-viz-bbc93b28591541aeb0a0d4805cad6b2a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-be2330f9891958bb9fa171602d30621d"}, "mark": {"type": "circle", "filled": true, "opacity": 1, "size": 60}, "encoding": {"color": {"field": "aa_substitutions", "scale": {"scheme": "tableau10"}, "title": "Amino acid substitutions", "type": "nominal"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "measured IC50", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "type": "nominal"}, {"field": "measured IC90", "type": "nominal"}, {"field": "measured IC80", "type": "quantitative"}, {"field": "mean_IC50", "format": ".3g", "type": "quantitative"}, {"field": "median_IC50", "format": ".3g", "type": "quantitative"}, {"field": "std_IC50", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "mean_IC80", "format": ".3g", "type": "quantitative"}, {"field": "median_IC80", "format": ".3g", "type": "quantitative"}, {"field": "std_IC80", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}], "x": {"field": "measured IC80", "scale": {"nice": false, "type": "log"}, "type": "quantitative"}, "y": {"field": "median_IC80", "scale": {"nice": false, "type": "log"}, "title": "predicted IC80 from DMS", "type": "quantitative"}}, "height": 150, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-be2330f9891958bb9fa171602d30621d": [{"antibody": "1-18", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.012082, "MAP_fold_enrichment": "", "measured IC90": "0.082944", "measured IC80": 0.040739, "mean_IC50": 0.14425178804652192, "median_IC50": 0.14822014093823493, "std_IC50": 0.04430806620769105, "frac_models": 1.0, "mean_IC80": 0.5770071521860879, "median_IC80": 0.5928805637529398, "std_IC80": 0.1772322648307645, "n_models": 3, "times_seen": null}, {"antibody": "1-18", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.004669, "MAP_fold_enrichment": "", "measured IC90": "0.035790", "measured IC80": 0.016877, "mean_IC50": 0.13561342447766792, "median_IC50": 0.14022359658143946, "std_IC50": 0.03785346462432929, "frac_models": 1.0, "mean_IC80": 0.5424536979106717, "median_IC80": 0.560894386325758, "std_IC80": 0.151413858497317, "n_models": 3, "times_seen": 7.333333333333333}, {"antibody": "1-18", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.005727, "MAP_fold_enrichment": "", "measured IC90": "0.014183", "measured IC80": 0.007466, "mean_IC50": 0.121673814173116, "median_IC50": 0.12050415744493265, "std_IC50": 0.029303634007258005, "frac_models": 1.0, "mean_IC80": 0.4866952566924641, "median_IC80": 0.48201662977973075, "std_IC80": 0.11721453602903212, "n_models": 3, "times_seen": 5.666666666666667}, {"antibody": "1-18", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.018143, "MAP_fold_enrichment": "", "measured IC90": "0.096897", "measured IC80": 0.052213, "mean_IC50": 0.1709926314569605, "median_IC50": 0.19258362344584, "std_IC50": 0.06364239748536592, "frac_models": 1.0, "mean_IC80": 0.6839705258278421, "median_IC80": 0.7703344937833605, "std_IC80": 0.2545695899414637, "n_models": 3, "times_seen": 3.6666666666666665}, {"antibody": "1-18", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.021138, "MAP_fold_enrichment": "", "measured IC90": "0.222059", "measured IC80": 0.093217, "mean_IC50": 0.48090778161736747, "median_IC50": 0.2021284861953023, "std_IC50": 0.5020983554971847, "frac_models": 1.0, "mean_IC80": 1.9236311264694699, "median_IC80": 0.8085139447812095, "std_IC80": 2.008393421988739, "n_models": 3, "times_seen": 2.6666666666666665}, {"antibody": "1-18", "aa_substitutions": "R476M", "max % neutralization": 100, "measured IC50": 0.010038, "MAP_fold_enrichment": "", "measured IC90": "0.059656", "measured IC80": 0.030902, "mean_IC50": 0.4806726621337027, "median_IC50": 0.4246126998692877, "std_IC50": 0.10042904675011459, "frac_models": 1.0, "mean_IC80": 1.9226906485348116, "median_IC80": 1.6984507994771518, "std_IC80": 0.4017161870004582, "n_models": 3, "times_seen": 9.666666666666666}, {"antibody": "1-18", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.031333, "MAP_fold_enrichment": "", "measured IC90": "0.116931", "measured IC80": 0.07192, "mean_IC50": 1.1805426420635936, "median_IC50": 1.080089189498945, "std_IC50": 0.6291515308814167, "frac_models": 1.0, "mean_IC80": 4.722170568254376, "median_IC80": 4.320356757995779, "std_IC80": 2.5166061235256687, "n_models": 3, "times_seen": 8.0}, {"antibody": "1-18", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.009627, "MAP_fold_enrichment": "", "measured IC90": "0.057201", "measured IC80": 0.029633, "mean_IC50": 0.14883597329431356, "median_IC50": 0.1518806077894721, "std_IC50": 0.04037561486344563, "frac_models": 1.0, "mean_IC80": 0.5953438931772542, "median_IC80": 0.6075224311578883, "std_IC80": 0.16150245945378264, "n_models": 3, "times_seen": 9.666666666666666}, {"antibody": "3BNC117", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.008877, "MAP_fold_enrichment": "", "measured IC90": "0.029162", "measured IC80": 0.018801, "mean_IC50": 1.4862875042618884, "median_IC50": 1.6945898379722986, "std_IC50": 1.3398091421782328, "frac_models": 1.0, "mean_IC80": 5.945150017047553, "median_IC80": 6.778359351889197, "std_IC80": 5.35923656871293, "n_models": 3, "times_seen": null}, {"antibody": "3BNC117", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.009945, "MAP_fold_enrichment": "", "measured IC90": "0.043379", "measured IC80": 0.025188, "mean_IC50": 2.1446411640823744, "median_IC50": 2.5999254147497823, "std_IC50": 1.9038046939511781, "frac_models": 1.0, "mean_IC80": 8.578564656329501, "median_IC80": 10.399701658999135, "std_IC80": 7.615218775804715, "n_models": 3, "times_seen": 8.333333333333334}, {"antibody": "3BNC117", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.006859, "MAP_fold_enrichment": "", "measured IC90": "0.007023", "measured IC80": 0.006859, "mean_IC50": 0.39586042211569117, "median_IC50": 0.48533024088439847, "std_IC50": 0.3067530637333685, "frac_models": 1.0, "mean_IC80": 1.583441688462765, "median_IC80": 1.9413209635375945, "std_IC80": 1.2270122549334748, "n_models": 3, "times_seen": 7.0}, {"antibody": "3BNC117", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.014342, "MAP_fold_enrichment": "", "measured IC90": "0.061920", "measured IC80": 0.03609, "mean_IC50": 2.7491743984460038, "median_IC50": 3.868816612316253, "std_IC50": 2.3447406010243057, "frac_models": 1.0, "mean_IC80": 10.996697593784019, "median_IC80": 15.475266449265014, "std_IC80": 9.378962404097223, "n_models": 3, "times_seen": 3.6666666666666665}, {"antibody": "3BNC117", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.004815, "MAP_fold_enrichment": "", "measured IC90": "0.036248", "measured IC80": 0.017207, "mean_IC50": 1.5909456176623984, "median_IC50": 1.9392063870638603, "std_IC50": 1.3949549785687716, "frac_models": 1.0, "mean_IC80": 6.363782470649596, "median_IC80": 7.756825548255446, "std_IC80": 5.579819914275087, "n_models": 3, "times_seen": 4.0}, {"antibody": "3BNC117", "aa_substitutions": "R476M", "max % neutralization": 100, "measured IC50": 0.002286, "MAP_fold_enrichment": "", "measured IC90": "0.010977", "measured IC80": 0.005776, "mean_IC50": 1.0805755417872382, "median_IC50": 0.9131089000847392, "std_IC50": 1.1193463730496453, "frac_models": 1.0, "mean_IC80": 4.322302167148955, "median_IC80": 3.652435600338958, "std_IC80": 4.477385492198583, "n_models": 3, "times_seen": 9.666666666666666}, {"antibody": "3BNC117", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.014858, "MAP_fold_enrichment": "", "measured IC90": "0.077048", "measured IC80": 0.041971, "mean_IC50": 4.852447728960837, "median_IC50": 6.388746123372633, "std_IC50": 4.243847539123866, "frac_models": 1.0, "mean_IC80": 19.409790915843356, "median_IC80": 25.554984493490544, "std_IC80": 16.97539015649547, "n_models": 3, "times_seen": 7.333333333333333}, {"antibody": "3BNC117", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.011801, "MAP_fold_enrichment": "", "measured IC90": "0.086449", "measured IC80": 0.041454, "mean_IC50": 1.9432305455343164, "median_IC50": 2.0368561837985055, "std_IC50": 1.8435865405257092, "frac_models": 1.0, "mean_IC80": 7.772922182137272, "median_IC80": 8.147424735194027, "std_IC80": 7.374346162102843, "n_models": 3, "times_seen": 10.333333333333334}, {"antibody": "IDC508", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.027578, "MAP_fold_enrichment": "", "measured IC90": "0.128032", "measured IC80": 0.07265, "mean_IC50": 0.14370494866071576, "median_IC50": 0.14370494866071576, "std_IC50": 0.05674636241201011, "frac_models": 1.0, "mean_IC80": 0.574819794642863, "median_IC80": 0.574819794642863, "std_IC80": 0.22698544964804024, "n_models": 2, "times_seen": null}, {"antibody": "IDC508", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.071885, "MAP_fold_enrichment": "", "measured IC90": "0.282387", "measured IC80": 0.170428, "mean_IC50": 0.6129641618773465, "median_IC50": 0.6129641618773465, "std_IC50": 0.3011747041621459, "frac_models": 1.0, "mean_IC80": 2.4518566475093877, "median_IC80": 2.4518566475093877, "std_IC80": 1.2046988166485852, "n_models": 2, "times_seen": 8.5}, {"antibody": "IDC508", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.039933, "MAP_fold_enrichment": "", "measured IC90": "0.221738", "measured IC80": 0.117778, "mean_IC50": 0.19645562445351092, "median_IC50": 0.19645562445351092, "std_IC50": 0.08352736138489078, "frac_models": 1.0, "mean_IC80": 0.7858224978140438, "median_IC80": 0.7858224978140438, "std_IC80": 0.3341094455395633, "n_models": 2, "times_seen": 8.0}, {"antibody": "IDC508", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.016793, "MAP_fold_enrichment": "", "measured IC90": "0.140093", "measured IC80": 0.064032, "mean_IC50": 0.23634995427981148, "median_IC50": 0.23634995427981148, "std_IC50": 0.13616128523256094, "frac_models": 1.0, "mean_IC80": 0.9453998171192464, "median_IC80": 0.9453998171192464, "std_IC80": 0.5446451409302442, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDC508", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.015866, "MAP_fold_enrichment": "", "measured IC90": "0.092614", "measured IC80": 0.048293, "mean_IC50": 0.16907483510587032, "median_IC50": 0.16907483510587032, "std_IC50": 0.04125646103184076, "frac_models": 1.0, "mean_IC80": 0.6762993404234815, "median_IC80": 0.6762993404234815, "std_IC80": 0.16502584412736304, "n_models": 2, "times_seen": 3.5}, {"antibody": "IDC508", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.025759, "MAP_fold_enrichment": "", "measured IC90": "0.198820", "measured IC80": 0.093518, "mean_IC50": 0.2200747424692628, "median_IC50": 0.2200747424692628, "std_IC50": 0.15812753344837224, "frac_models": 1.0, "mean_IC80": 0.8802989698770515, "median_IC80": 0.8802989698770515, "std_IC80": 0.632510133793489, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDC508", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.028952, "MAP_fold_enrichment": "", "measured IC90": "0.230193", "measured IC80": 0.107096, "mean_IC50": 0.24490435155391654, "median_IC50": 0.24490435155391654, "std_IC50": 0.03206489919551436, "frac_models": 1.0, "mean_IC80": 0.9796174062156664, "median_IC80": 0.9796174062156664, "std_IC80": 0.12825959678205745, "n_models": 2, "times_seen": 9.5}, {"antibody": "IDC508", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.033261, "MAP_fold_enrichment": "", "measured IC90": "0.206739", "measured IC80": 0.105335, "mean_IC50": 0.2432891117409928, "median_IC50": 0.2432891117409928, "std_IC50": 0.07657578207636911, "frac_models": 1.0, "mean_IC80": 0.9731564469639715, "median_IC80": 0.9731564469639715, "std_IC80": 0.3063031283054763, "n_models": 2, "times_seen": 3.5}, {"antibody": "IDC513", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.337497, "MAP_fold_enrichment": "", "measured IC90": "1.368177", "measured IC80": 0.816196, "mean_IC50": 0.9039054134751078, "median_IC50": 0.9039054134751078, "std_IC50": 0.6298709068118872, "frac_models": 1.0, "mean_IC80": 3.6156216539004324, "median_IC80": 3.6156216539004324, "std_IC80": 2.5194836272475496, "n_models": 2, "times_seen": null}, {"antibody": "IDC513", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.552039, "MAP_fold_enrichment": "", "measured IC90": "3.256033", "measured IC80": 1.691372, "mean_IC50": 12.31354345565891, "median_IC50": 12.31354345565891, "std_IC50": 6.975156481806003, "frac_models": 1.0, "mean_IC80": 49.254173822635664, "median_IC80": 49.254173822635664, "std_IC80": 27.900625927224034, "n_models": 2, "times_seen": 8.0}, {"antibody": "IDC513", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.802481, "MAP_fold_enrichment": "", "measured IC90": "2.264337", "measured IC80": 1.54409, "mean_IC50": 5.198791949515596, "median_IC50": 5.198791949515596, "std_IC50": 5.135438758298202, "frac_models": 1.0, "mean_IC80": 20.795167798062387, "median_IC80": 20.795167798062387, "std_IC80": 20.54175503319281, "n_models": 2, "times_seen": 7.0}, {"antibody": "IDC513", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.046666, "MAP_fold_enrichment": "", "measured IC90": "0.287156", "measured IC80": 0.146852, "mean_IC50": 0.4362140724907243, "median_IC50": 0.4362140724907243, "std_IC50": 0.1037815817645659, "frac_models": 1.0, "mean_IC80": 1.7448562899628977, "median_IC80": 1.7448562899628977, "std_IC80": 0.4151263270582642, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDC513", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.186853, "MAP_fold_enrichment": "", "measured IC90": "1.122398", "measured IC80": 0.579124, "mean_IC50": 1.2781037227659375, "median_IC50": 1.2781037227659375, "std_IC50": 1.1383852405048545, "frac_models": 1.0, "mean_IC80": 5.112414891063751, "median_IC80": 5.112414891063751, "std_IC80": 4.553540962019419, "n_models": 2, "times_seen": 3.0}, {"antibody": "IDC513", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.083944, "MAP_fold_enrichment": "", "measured IC90": "1.219105", "measured IC80": 0.454112, "mean_IC50": 1.0073684672765242, "median_IC50": 1.0073684672765242, "std_IC50": 0.6900730475668916, "frac_models": 1.0, "mean_IC80": 4.029473869106098, "median_IC80": 4.029473869106098, "std_IC80": 2.7602921902675672, "n_models": 2, "times_seen": 4.0}, {"antibody": "IDC513", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.308683, "MAP_fold_enrichment": "", "measured IC90": "1.832622", "measured IC80": 0.949675, "mean_IC50": 1.9764593680951938, "median_IC50": 1.9764593680951938, "std_IC50": 2.058482596723508, "frac_models": 1.0, "mean_IC80": 7.905837472380779, "median_IC80": 7.905837472380779, "std_IC80": 8.233930386894038, "n_models": 2, "times_seen": 6.5}, {"antibody": "IDC513", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.249794, "MAP_fold_enrichment": "", "measured IC90": "1.671103", "measured IC80": 0.828638, "mean_IC50": 1.2901436066010903, "median_IC50": 1.2901436066010903, "std_IC50": 0.9256041494418218, "frac_models": 1.0, "mean_IC80": 5.160574426404362, "median_IC80": 5.160574426404362, "std_IC80": 3.7024165977672867, "n_models": 2, "times_seen": 8.5}, {"antibody": "IDC513", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.331378, "MAP_fold_enrichment": "", "measured IC90": "1.817576", "measured IC80": 0.969812, "mean_IC50": 1.214970394567226, "median_IC50": 1.214970394567226, "std_IC50": 0.9288624954338184, "frac_models": 1.0, "mean_IC80": 4.859881578268904, "median_IC80": 4.859881578268904, "std_IC80": 3.7154499817352726, "n_models": 2, "times_seen": 4.0}, {"antibody": "IDC561", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.049447, "MAP_fold_enrichment": "", "measured IC90": "0.296411", "measured IC80": 0.153056, "mean_IC50": 0.09157469322318051, "median_IC50": 0.08323110246844842, "std_IC50": 0.020157978590530715, "frac_models": 1.0, "mean_IC80": 0.3662987728927221, "median_IC80": 0.3329244098737939, "std_IC80": 0.08063191436212278, "n_models": 3, "times_seen": null}, {"antibody": "IDC561", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.013112, "MAP_fold_enrichment": "", "measured IC90": "0.104547", "measured IC80": 0.048589, "mean_IC50": 0.08939492356594232, "median_IC50": 0.08205116601662524, "std_IC50": 0.01764425024712396, "frac_models": 1.0, "mean_IC80": 0.35757969426376945, "median_IC80": 0.32820466406650095, "std_IC80": 0.07057700098849587, "n_models": 3, "times_seen": 8.0}, {"antibody": "IDC561", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.073617, "MAP_fold_enrichment": "", "measured IC90": "0.361579", "measured IC80": 0.200952, "mean_IC50": 0.12988654946799474, "median_IC50": 0.11651472848804216, "std_IC50": 0.04457665279339992, "frac_models": 1.0, "mean_IC80": 0.5195461978719791, "median_IC80": 0.46605891395216875, "std_IC80": 0.1783066111735997, "n_models": 3, "times_seen": 7.666666666666667}, {"antibody": "IDC561", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.009251, "MAP_fold_enrichment": "", "measured IC90": "0.053783", "measured IC80": 0.028087, "mean_IC50": 0.08535888032233498, "median_IC50": 0.07770920277095138, "std_IC50": 0.01580924337005506, "frac_models": 1.0, "mean_IC80": 0.34143552128934007, "median_IC80": 0.3108368110838055, "std_IC80": 0.06323697348022043, "n_models": 3, "times_seen": 5.666666666666667}, {"antibody": "IDC561", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.071085, "MAP_fold_enrichment": "", "measured IC90": "0.377252", "measured IC80": 0.203756, "mean_IC50": 0.47467219527226884, "median_IC50": 0.2908474481798491, "std_IC50": 0.34976708598154105, "frac_models": 1.0, "mean_IC80": 1.8986887810890754, "median_IC80": 1.1633897927193964, "std_IC80": 1.399068343926164, "n_models": 3, "times_seen": 4.666666666666667}, {"antibody": "IDC561", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.040781, "MAP_fold_enrichment": "", "measured IC90": "0.269964", "measured IC80": 0.134386, "mean_IC50": 0.27302003710544964, "median_IC50": 0.25210686381445324, "std_IC50": 0.04094406900338314, "frac_models": 1.0, "mean_IC80": 1.0920801484217986, "median_IC80": 1.0084274552578132, "std_IC80": 0.16377627601353245, "n_models": 3, "times_seen": 4.0}, {"antibody": "IDF033", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.06021, "MAP_fold_enrichment": "", "measured IC90": "0.215510", "measured IC80": 0.13461, "mean_IC50": 0.1591945142978397, "median_IC50": 0.1591945142978397, "std_IC50": 0.03902752035936558, "frac_models": 1.0, "mean_IC80": 0.6367780571913589, "median_IC80": 0.6367780571913589, "std_IC80": 0.15611008143746216, "n_models": 2, "times_seen": null}, {"antibody": "IDF033", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.08697, "MAP_fold_enrichment": "", "measured IC90": "0.440192", "measured IC80": 0.241945, "mean_IC50": 0.9800189379935189, "median_IC50": 0.9800189379935189, "std_IC50": 0.07180982154713121, "frac_models": 1.0, "mean_IC80": 3.9200757519740765, "median_IC80": 3.9200757519740765, "std_IC80": 0.2872392861885253, "n_models": 2, "times_seen": 8.5}, {"antibody": "IDF033", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.06644, "MAP_fold_enrichment": "", "measured IC90": "0.403075", "measured IC80": 0.207215, "mean_IC50": 0.1897988904788384, "median_IC50": 0.1897988904788384, "std_IC50": 0.07209835878025393, "frac_models": 1.0, "mean_IC80": 0.7591955619153541, "median_IC80": 0.7591955619153541, "std_IC80": 0.28839343512101584, "n_models": 2, "times_seen": 8.0}, {"antibody": "IDF033", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.172088, "MAP_fold_enrichment": "", "measured IC90": "0.655129", "measured IC80": 0.399994, "mean_IC50": 1.2480072334633763, "median_IC50": 1.2480072334633763, "std_IC50": 0.21169558961075458, "frac_models": 1.0, "mean_IC80": 4.992028933853504, "median_IC80": 4.992028933853504, "std_IC80": 0.8467823584430174, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDF033", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.075948, "MAP_fold_enrichment": "", "measured IC90": "0.248057", "measured IC80": 0.160264, "mean_IC50": 0.3520537086182483, "median_IC50": 0.3520537086182483, "std_IC50": 0.2872423181812376, "frac_models": 1.0, "mean_IC80": 1.4082148344729937, "median_IC80": 1.4082148344729937, "std_IC80": 1.1489692727249503, "n_models": 2, "times_seen": 3.0}, {"antibody": "IDF033", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.030449, "MAP_fold_enrichment": "", "measured IC90": "0.250743", "measured IC80": 0.115156, "mean_IC50": 0.16149359767254168, "median_IC50": 0.16149359767254168, "std_IC50": 0.04429117035649022, "frac_models": 1.0, "mean_IC80": 0.6459743906901667, "median_IC80": 0.6459743906901667, "std_IC80": 0.17716468142596065, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDF033", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.042198, "MAP_fold_enrichment": "", "measured IC90": "0.298770", "measured IC80": 0.145081, "mean_IC50": 0.16849724927195683, "median_IC50": 0.16849724927195683, "std_IC50": 0.04286932249918226, "frac_models": 1.0, "mean_IC80": 0.6739889970878276, "median_IC80": 0.6739889970878276, "std_IC80": 0.17147728999672887, "n_models": 2, "times_seen": 3.5}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<p>Now also calculate the fold changes, using the <strong>median</strong> prediction:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sera_validation_vs_prediction</span> <span class="o">=</span> <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody!=&quot;PGT151&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sera_validation_vs_prediction</span><span class="p">[</span><span class="s1">&#39;median_IC80&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sera_validation_vs_prediction</span><span class="p">[</span><span class="s1">&#39;median_IC80&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sera_validation_vs_prediction</span><span class="p">[</span><span class="s1">&#39;measured IC80&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sera_validation_vs_prediction</span><span class="p">[</span><span class="s1">&#39;measured IC80&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>


<span class="n">fold_changes</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">sera_validation_vs_prediction</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;median_IC80&quot;</span><span class="p">:</span> <span class="s2">&quot;predicted IC80&quot;</span><span class="p">})</span>
<span class="c1">#    .query(&quot;aa_substitutions != &#39;&#39;&quot;)</span>
    <span class="p">[[</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span>
      <span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
      <span class="s2">&quot;measured IC80&quot;</span><span class="p">,</span>
      <span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">,</span>
      <span class="s2">&quot;predicted IC80&quot;</span><span class="p">,</span>
      <span class="s2">&quot;max % neutralization&quot;</span><span class="p">,</span>
      <span class="s2">&quot;times_seen&quot;</span><span class="p">,</span>
      <span class="s2">&quot;frac_models&quot;</span><span class="p">,</span>
      <span class="s2">&quot;n_models&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">sera_validation_vs_prediction</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;median_IC80&quot;</span><span class="p">:</span> <span class="s2">&quot;predicted IC80&quot;</span><span class="p">})</span>
        <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;aa_substitutions == &#39;&#39;&quot;</span><span class="p">)</span>
        <span class="p">[[</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="s2">&quot;measured IC80&quot;</span><span class="p">,</span> <span class="s2">&quot;predicted IC80&quot;</span><span class="p">]],</span>
        <span class="n">on</span><span class="o">=</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;many_to_one&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot; mutant&quot;</span><span class="p">,</span> <span class="s2">&quot; unmutated&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">measured_fold_change</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;measured IC80 mutant&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;measured IC80 unmutated&quot;</span><span class="p">],</span>
        <span class="n">predicted_fold_change</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;predicted IC80 mutant&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;predicted IC80 unmutated&quot;</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">plot_data</span> <span class="o">=</span> <span class="n">fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody!=&quot;PGT151&quot;&#39;</span><span class="p">)</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="o">~</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>

<span class="n">fold_change_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">&quot;measured_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;measured fold change IC80&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;predicted fold change IC80&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Amino acid substitutions&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;tableau10&quot;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">plot_data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">antibody</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;antibody&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;antibody==@antibody&quot;</span><span class="p">)</span>
    <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="p">[</span><span class="o">~</span><span class="n">antibody_df</span><span class="p">[</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted fold change correlation (R^2): </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fold_change_chart</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1-18:
Predicted fold change correlation (R^2): 0.184
3BNC117:
Predicted fold change correlation (R^2): 0.616
IDC508:
Predicted fold change correlation (R^2): 0.686
IDC513:
Predicted fold change correlation (R^2): 0.67
IDC561:
Predicted fold change correlation (R^2): 0.307
IDF033:
Predicted fold change correlation (R^2): 0.821
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-bbf11c7f1ef14276b1c935608f7faded"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-bbf11c7f1ef14276b1c935608f7faded") {
      outputDiv = document.getElementById("altair-viz-bbf11c7f1ef14276b1c935608f7faded");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-c7546b1cdb30ba1021a2e69c411706f9"}, "mark": {"type": "circle", "filled": true, "opacity": 1, "size": 60}, "encoding": {"color": {"field": "aa_substitutions", "scale": {"scheme": "tableau10"}, "title": "Amino acid substitutions", "type": "nominal"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "measured IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "type": "nominal"}, {"field": "predicted IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "measured IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "measured_fold_change", "format": ".3g", "type": "quantitative"}, {"field": "predicted_fold_change", "format": ".3g", "type": "quantitative"}], "x": {"field": "measured_fold_change", "scale": {"nice": false, "type": "log"}, "title": "measured fold change IC80", "type": "quantitative"}, "y": {"field": "predicted_fold_change", "scale": {"nice": false, "type": "log"}, "title": "predicted fold change IC80", "type": "quantitative"}}, "height": 150, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-c7546b1cdb30ba1021a2e69c411706f9": [{"antibody": "1-18", "aa_substitutions": "", "measured IC80 mutant": 0.040739, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.5928805637529398, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "1-18", "aa_substitutions": "G459D", "measured IC80 mutant": 0.016877, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.560894386325758, "max % neutralization": 100, "times_seen": 7.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.41427133704803754, "predicted_fold_change": 0.9460495428881848}, {"antibody": "1-18", "aa_substitutions": "N276D", "measured IC80 mutant": 0.007466, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.48201662977973075, "max % neutralization": 100, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.18326419401556251, "predicted_fold_change": 0.8130079804413906}, {"antibody": "1-18", "aa_substitutions": "N463S", "measured IC80 mutant": 0.052213, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7703344937833605, "max % neutralization": 100, "times_seen": 3.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 1.2816465794447582, "predicted_fold_change": 1.299308057776655}, {"antibody": "1-18", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.093217, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.8085139447812095, "max % neutralization": 100, "times_seen": 2.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 2.2881514028326664, "predicted_fold_change": 1.3637045877559355}, {"antibody": "1-18", "aa_substitutions": "R476M", "measured IC80 mutant": 0.030902, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.6984507994771518, "max % neutralization": 100, "times_seen": 9.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.7585360465401704, "predicted_fold_change": 2.8647435981472245}, {"antibody": "1-18", "aa_substitutions": "T198D", "measured IC80 mutant": 0.07192, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.320356757995779, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 1.7653845209749872, "predicted_fold_change": 7.287060872172766}, {"antibody": "1-18", "aa_substitutions": "T202P", "measured IC80 mutant": 0.029633, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6075224311578883, "max % neutralization": 100, "times_seen": 9.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.7273865337882619, "predicted_fold_change": 1.0246961501187781}, {"antibody": "3BNC117", "aa_substitutions": "", "measured IC80 mutant": 0.018801, "MAP_fold_enrichment": "", "predicted IC80 mutant": 6.778359351889197, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "3BNC117", "aa_substitutions": "G459D", "measured IC80 mutant": 0.025188, "MAP_fold_enrichment": "", "predicted IC80 mutant": 10.399701658999135, "max % neutralization": 100, "times_seen": 8.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 1.3397159725546515, "predicted_fold_change": 1.5342505640543582}, {"antibody": "3BNC117", "aa_substitutions": "N276D", "measured IC80 mutant": 0.006859, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.9413209635375945, "max % neutralization": 100, "times_seen": 7.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.3648210201585022, "predicted_fold_change": 0.28639982962787724}, {"antibody": "3BNC117", "aa_substitutions": "N463S", "measured IC80 mutant": 0.03609, "MAP_fold_enrichment": "", "predicted IC80 mutant": 15.475266449265014, "max % neutralization": 100, "times_seen": 3.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 1.919578745811393, "predicted_fold_change": 2.2830401349187692}, {"antibody": "3BNC117", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.017207, "MAP_fold_enrichment": "", "predicted IC80 mutant": 7.756825548255446, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.9152172756768258, "predicted_fold_change": 1.1443514788122793}, {"antibody": "3BNC117", "aa_substitutions": "R476M", "measured IC80 mutant": 0.005776, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.652435600338958, "max % neutralization": 100, "times_seen": 9.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.30721770118610714, "predicted_fold_change": 0.5388377055165994}, {"antibody": "3BNC117", "aa_substitutions": "T198D", "measured IC80 mutant": 0.041971, "MAP_fold_enrichment": "", "predicted IC80 mutant": 25.554984493490544, "max % neutralization": 100, "times_seen": 7.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 2.232381256316154, "predicted_fold_change": 3.7700840523257466}, {"antibody": "3BNC117", "aa_substitutions": "T202P", "measured IC80 mutant": 0.041454, "MAP_fold_enrichment": "", "predicted IC80 mutant": 8.147424735194027, "max % neutralization": 100, "times_seen": 10.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 2.2048827190043085, "predicted_fold_change": 1.2019759225251547}, {"antibody": "IDC508", "aa_substitutions": "", "measured IC80 mutant": 0.07265, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.574819794642863, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC508", "aa_substitutions": "G459D", "measured IC80 mutant": 0.170428, "MAP_fold_enrichment": "", "predicted IC80 mutant": 2.4518566475093877, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.3458774948382652, "predicted_fold_change": 4.26543530748229}, {"antibody": "IDC508", "aa_substitutions": "G471H", "measured IC80 mutant": 0.117778, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7858224978140438, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.6211699931176873, "predicted_fold_change": 1.3670762648357948}, {"antibody": "IDC508", "aa_substitutions": "N276D", "measured IC80 mutant": 0.064032, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9453998171192464, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 0.8813764624913971, "predicted_fold_change": 1.644689041557147}, {"antibody": "IDC508", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.048293, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6762993404234815, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 0.664735030970406, "predicted_fold_change": 1.1765414947891069}, {"antibody": "IDC508", "aa_substitutions": "T198D", "measured IC80 mutant": 0.093518, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.8802989698770515, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.2872401927047488, "predicted_fold_change": 1.5314346828017351}, {"antibody": "IDC508", "aa_substitutions": "T202P", "measured IC80 mutant": 0.107096, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9796174062156664, "max % neutralization": 100, "times_seen": 9.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.4741362697866482, "predicted_fold_change": 1.7042165481171454}, {"antibody": "IDC508", "aa_substitutions": "V164F", "measured IC80 mutant": 0.105335, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9731564469639715, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.4498967653131452, "predicted_fold_change": 1.6929765746299603}, {"antibody": "IDC513", "aa_substitutions": "", "measured IC80 mutant": 0.816196, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.6156216539004324, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC513", "aa_substitutions": "G459D", "measured IC80 mutant": 1.691372, "MAP_fold_enrichment": "", "predicted IC80 mutant": 49.254173822635664, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 2.0722620547025468, "predicted_fold_change": 13.622601736965931}, {"antibody": "IDC513", "aa_substitutions": "G471H", "measured IC80 mutant": 1.54409, "MAP_fold_enrichment": "", "predicted IC80 mutant": 20.795167798062387, "max % neutralization": 100, "times_seen": 7.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.8918127508588622, "predicted_fold_change": 5.751477833868247}, {"antibody": "IDC513", "aa_substitutions": "N276D", "measured IC80 mutant": 0.146852, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.7448562899628977, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.17992246960288952, "predicted_fold_change": 0.4825881845465205}, {"antibody": "IDC513", "aa_substitutions": "N463S", "measured IC80 mutant": 0.579124, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.112414891063751, "max % neutralization": 100, "times_seen": 3.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.7095403555028449, "predicted_fold_change": 1.4139794979788938}, {"antibody": "IDC513", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.454112, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.029473869106098, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.5563761645487113, "predicted_fold_change": 1.1144622570669729}, {"antibody": "IDC513", "aa_substitutions": "T198D", "measured IC80 mutant": 0.949675, "MAP_fold_enrichment": "", "predicted IC80 mutant": 7.905837472380779, "max % neutralization": 100, "times_seen": 6.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.1635379247141617, "predicted_fold_change": 2.186577642561738}, {"antibody": "IDC513", "aa_substitutions": "T202P", "measured IC80 mutant": 0.828638, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.160574426404362, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.0152438874976109, "predicted_fold_change": 1.4272993472193856}, {"antibody": "IDC513", "aa_substitutions": "V164F", "measured IC80 mutant": 0.969812, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.859881578268904, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.1882096947301872, "predicted_fold_change": 1.344134437580381}, {"antibody": "IDC561", "aa_substitutions": "", "measured IC80 mutant": 0.153056, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3329244098737939, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC561", "aa_substitutions": "G459D", "measured IC80 mutant": 0.048589, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.32820466406650095, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.31745896926615097, "predicted_fold_change": 0.98582337110973}, {"antibody": "IDC561", "aa_substitutions": "G471H", "measured IC80 mutant": 0.200952, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.46605891395216875, "max % neutralization": 100, "times_seen": 7.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.3129312147187957, "predicted_fold_change": 1.3998940904598853}, {"antibody": "IDC561", "aa_substitutions": "N276D", "measured IC80 mutant": 0.028087, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3108368110838055, "max % neutralization": 100, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.18350799707296678, "predicted_fold_change": 0.9336558145485294}, {"antibody": "IDC561", "aa_substitutions": "T198D", "measured IC80 mutant": 0.203756, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1633897927193964, "max % neutralization": 100, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.331251306711269, "predicted_fold_change": 3.4944562736040234}, {"antibody": "IDC561", "aa_substitutions": "V164F", "measured IC80 mutant": 0.134386, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.0084274552578132, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.8780185030315701, "predicted_fold_change": 3.0289982511047815}, {"antibody": "IDF033", "aa_substitutions": "", "measured IC80 mutant": 0.13461, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6367780571913589, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDF033", "aa_substitutions": "G459D", "measured IC80 mutant": 0.241945, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.9200757519740765, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.7973776093900897, "predicted_fold_change": 6.156109978513361}, {"antibody": "IDF033", "aa_substitutions": "G471H", "measured IC80 mutant": 0.207215, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7591955619153541, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.5393730034915682, "predicted_fold_change": 1.1922451682206872}, {"antibody": "IDF033", "aa_substitutions": "N276D", "measured IC80 mutant": 0.399994, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.992028933853504, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 2.9715028601144047, "predicted_fold_change": 7.839511549552882}, {"antibody": "IDF033", "aa_substitutions": "N463S", "measured IC80 mutant": 0.160264, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.4082148344729937, "max % neutralization": 100, "times_seen": 3.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.1905801946363568, "predicted_fold_change": 2.211468844708965}, {"antibody": "IDF033", "aa_substitutions": "T198D", "measured IC80 mutant": 0.115156, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6459743906901667, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 0.8554787905801946, "predicted_fold_change": 1.0144419761248842}, {"antibody": "IDF033", "aa_substitutions": "V164F", "measured IC80 mutant": 0.145081, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6739889970878276, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.0777876829358888, "predicted_fold_change": 1.0584362785058818}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<p>And now repeat these calculation and plots, this time including multi-mutants:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All mutant correlations between DMS predicted and neutralization assay measured IC80s:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">antibody</span><span class="p">,</span> <span class="n">antibody_df</span> <span class="ow">in</span> <span class="n">sera_validation_vs_prediction</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;antibody&#39;</span><span class="p">):</span>
    <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;aa_substitutions!=&#39;&#39;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;median_IC80&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured IC80&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">antibody</span> <span class="o">==</span> <span class="s2">&quot;PGT151&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PGT151 MAP_fold_enrichment correlation:&quot;</span><span class="p">)</span>
        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
            <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured IC50&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
All mutant correlations between DMS predicted and neutralization assay measured IC80s:
1-18:
0.074
3BNC117:
0.637
IDC508:
0.78
IDC513:
0.377
IDC561:
0.057
IDF033:
0.76
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">sera_validation_vs_prediction</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody!=&quot;PGT151&quot;&#39;</span><span class="p">)</span>

<span class="n">corr_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;measured IC80&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;median_IC80&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;predicted IC80 from DMS&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Amino acid substitutions&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;tableau20&quot;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">validation_vs_prediction</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">corr_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-2fc687979af2473b99b5978fee70d4f5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2fc687979af2473b99b5978fee70d4f5") {
      outputDiv = document.getElementById("altair-viz-2fc687979af2473b99b5978fee70d4f5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-7536a2716cb0137b191eaa7dc9bd2d9c"}, "mark": {"type": "circle", "filled": true, "opacity": 1, "size": 60}, "encoding": {"color": {"field": "aa_substitutions", "scale": {"scheme": "tableau20"}, "title": "Amino acid substitutions", "type": "nominal"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "measured IC50", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "type": "nominal"}, {"field": "measured IC90", "type": "nominal"}, {"field": "measured IC80", "type": "quantitative"}, {"field": "mean_IC50", "format": ".3g", "type": "quantitative"}, {"field": "median_IC50", "format": ".3g", "type": "quantitative"}, {"field": "std_IC50", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "mean_IC80", "format": ".3g", "type": "quantitative"}, {"field": "median_IC80", "format": ".3g", "type": "quantitative"}, {"field": "std_IC80", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}], "x": {"field": "measured IC80", "scale": {"nice": false, "type": "log"}, "type": "quantitative"}, "y": {"field": "median_IC80", "scale": {"nice": false, "type": "log"}, "title": "predicted IC80 from DMS", "type": "quantitative"}}, "height": 150, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-7536a2716cb0137b191eaa7dc9bd2d9c": [{"antibody": "1-18", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.012082, "MAP_fold_enrichment": "", "measured IC90": "0.082944", "measured IC80": 0.040739, "mean_IC50": 0.14425178804652192, "median_IC50": 0.14822014093823493, "std_IC50": 0.04430806620769105, "frac_models": 1.0, "mean_IC80": 0.5770071521860879, "median_IC80": 0.5928805637529398, "std_IC80": 0.1772322648307645, "n_models": 3, "times_seen": null}, {"antibody": "1-18", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.004669, "MAP_fold_enrichment": "", "measured IC90": "0.035790", "measured IC80": 0.016877, "mean_IC50": 0.13561342447766792, "median_IC50": 0.14022359658143946, "std_IC50": 0.03785346462432929, "frac_models": 1.0, "mean_IC80": 0.5424536979106717, "median_IC80": 0.560894386325758, "std_IC80": 0.151413858497317, "n_models": 3, "times_seen": 7.333333333333333}, {"antibody": "1-18", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.005727, "MAP_fold_enrichment": "", "measured IC90": "0.014183", "measured IC80": 0.007466, "mean_IC50": 0.121673814173116, "median_IC50": 0.12050415744493265, "std_IC50": 0.029303634007258005, "frac_models": 1.0, "mean_IC80": 0.4866952566924641, "median_IC80": 0.48201662977973075, "std_IC80": 0.11721453602903212, "n_models": 3, "times_seen": 5.666666666666667}, {"antibody": "1-18", "aa_substitutions": "N276D G459D", "max % neutralization": 100, "measured IC50": 0.001909, "MAP_fold_enrichment": "", "measured IC90": "0.007638", "measured IC80": 0.004369, "mean_IC50": 0.11454265678599096, "median_IC50": 0.1140029030669044, "std_IC50": 0.02414485896160197, "frac_models": 1.0, "mean_IC80": 0.4581706271439639, "median_IC80": 0.4560116122676177, "std_IC80": 0.09657943584640781, "n_models": 3, "times_seen": null}, {"antibody": "1-18", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.018143, "MAP_fold_enrichment": "", "measured IC90": "0.096897", "measured IC80": 0.052213, "mean_IC50": 0.1709926314569605, "median_IC50": 0.19258362344584, "std_IC50": 0.06364239748536592, "frac_models": 1.0, "mean_IC80": 0.6839705258278421, "median_IC80": 0.7703344937833605, "std_IC80": 0.2545695899414637, "n_models": 3, "times_seen": 3.6666666666666665}, {"antibody": "1-18", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.021138, "MAP_fold_enrichment": "", "measured IC90": "0.222059", "measured IC80": 0.093217, "mean_IC50": 0.48090778161736747, "median_IC50": 0.2021284861953023, "std_IC50": 0.5020983554971847, "frac_models": 1.0, "mean_IC80": 1.9236311264694699, "median_IC80": 0.8085139447812095, "std_IC80": 2.008393421988739, "n_models": 3, "times_seen": 2.6666666666666665}, {"antibody": "1-18", "aa_substitutions": "R476M", "max % neutralization": 100, "measured IC50": 0.010038, "MAP_fold_enrichment": "", "measured IC90": "0.059656", "measured IC80": 0.030902, "mean_IC50": 0.4806726621337027, "median_IC50": 0.4246126998692877, "std_IC50": 0.10042904675011459, "frac_models": 1.0, "mean_IC80": 1.9226906485348116, "median_IC80": 1.6984507994771518, "std_IC80": 0.4017161870004582, "n_models": 3, "times_seen": 9.666666666666666}, {"antibody": "1-18", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.031333, "MAP_fold_enrichment": "", "measured IC90": "0.116931", "measured IC80": 0.07192, "mean_IC50": 1.1805426420635936, "median_IC50": 1.080089189498945, "std_IC50": 0.6291515308814167, "frac_models": 1.0, "mean_IC80": 4.722170568254376, "median_IC80": 4.320356757995779, "std_IC80": 2.5166061235256687, "n_models": 3, "times_seen": 8.0}, {"antibody": "1-18", "aa_substitutions": "T198D N276D", "max % neutralization": 100, "measured IC50": 0.005844, "MAP_fold_enrichment": "", "measured IC90": "0.031707", "measured IC80": 0.016986, "mean_IC50": 0.9869796716925725, "median_IC50": 0.8781211306511153, "std_IC50": 0.4749187768959323, "frac_models": 1.0, "mean_IC80": 3.9479186867702905, "median_IC80": 3.5124845226044616, "std_IC80": 1.8996751075837293, "n_models": 3, "times_seen": null}, {"antibody": "1-18", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.009627, "MAP_fold_enrichment": "", "measured IC90": "0.057201", "measured IC80": 0.029633, "mean_IC50": 0.14883597329431356, "median_IC50": 0.1518806077894721, "std_IC50": 0.04037561486344563, "frac_models": 1.0, "mean_IC80": 0.5953438931772542, "median_IC80": 0.6075224311578883, "std_IC80": 0.16150245945378264, "n_models": 3, "times_seen": 9.666666666666666}, {"antibody": "3BNC117", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.008877, "MAP_fold_enrichment": "", "measured IC90": "0.029162", "measured IC80": 0.018801, "mean_IC50": 1.4862875042618884, "median_IC50": 1.6945898379722986, "std_IC50": 1.3398091421782328, "frac_models": 1.0, "mean_IC80": 5.945150017047553, "median_IC80": 6.778359351889197, "std_IC80": 5.35923656871293, "n_models": 3, "times_seen": null}, {"antibody": "3BNC117", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.009945, "MAP_fold_enrichment": "", "measured IC90": "0.043379", "measured IC80": 0.025188, "mean_IC50": 2.1446411640823744, "median_IC50": 2.5999254147497823, "std_IC50": 1.9038046939511781, "frac_models": 1.0, "mean_IC80": 8.578564656329501, "median_IC80": 10.399701658999135, "std_IC80": 7.615218775804715, "n_models": 3, "times_seen": 8.333333333333334}, {"antibody": "3BNC117", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.006859, "MAP_fold_enrichment": "", "measured IC90": "0.007023", "measured IC80": 0.006859, "mean_IC50": 0.39586042211569117, "median_IC50": 0.48533024088439847, "std_IC50": 0.3067530637333685, "frac_models": 1.0, "mean_IC80": 1.583441688462765, "median_IC80": 1.9413209635375945, "std_IC80": 1.2270122549334748, "n_models": 3, "times_seen": 7.0}, {"antibody": "3BNC117", "aa_substitutions": "N276D G459D", "max % neutralization": 100, "measured IC50": 0.002286, "MAP_fold_enrichment": "", "measured IC90": "0.012884", "measured IC80": 0.006653, "mean_IC50": 0.5675368920391209, "median_IC50": 0.744618195829526, "std_IC50": 0.4515704990638294, "frac_models": 1.0, "mean_IC80": 2.2701475681564847, "median_IC80": 2.978472783318105, "std_IC80": 1.8062819962553183, "n_models": 3, "times_seen": null}, {"antibody": "3BNC117", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.014342, "MAP_fold_enrichment": "", "measured IC90": "0.061920", "measured IC80": 0.03609, "mean_IC50": 2.7491743984460038, "median_IC50": 3.868816612316253, "std_IC50": 2.3447406010243057, "frac_models": 1.0, "mean_IC80": 10.996697593784019, "median_IC80": 15.475266449265014, "std_IC80": 9.378962404097223, "n_models": 3, "times_seen": 3.6666666666666665}, {"antibody": "3BNC117", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.004815, "MAP_fold_enrichment": "", "measured IC90": "0.036248", "measured IC80": 0.017207, "mean_IC50": 1.5909456176623984, "median_IC50": 1.9392063870638603, "std_IC50": 1.3949549785687716, "frac_models": 1.0, "mean_IC80": 6.363782470649596, "median_IC80": 7.756825548255446, "std_IC80": 5.579819914275087, "n_models": 3, "times_seen": 4.0}, {"antibody": "3BNC117", "aa_substitutions": "R476M", "max % neutralization": 100, "measured IC50": 0.002286, "MAP_fold_enrichment": "", "measured IC90": "0.010977", "measured IC80": 0.005776, "mean_IC50": 1.0805755417872382, "median_IC50": 0.9131089000847392, "std_IC50": 1.1193463730496453, "frac_models": 1.0, "mean_IC80": 4.322302167148955, "median_IC80": 3.652435600338958, "std_IC80": 4.477385492198583, "n_models": 3, "times_seen": 9.666666666666666}, {"antibody": "3BNC117", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.014858, "MAP_fold_enrichment": "", "measured IC90": "0.077048", "measured IC80": 0.041971, "mean_IC50": 4.852447728960837, "median_IC50": 6.388746123372633, "std_IC50": 4.243847539123866, "frac_models": 1.0, "mean_IC80": 19.409790915843356, "median_IC80": 25.554984493490544, "std_IC80": 16.97539015649547, "n_models": 3, "times_seen": 7.333333333333333}, {"antibody": "3BNC117", "aa_substitutions": "T198D N276D", "max % neutralization": 100, "measured IC50": 0.003867, "MAP_fold_enrichment": "", "measured IC90": "0.016380", "measured IC80": 0.009615, "mean_IC50": 1.27470901990213, "median_IC50": 1.8297358012696834, "std_IC50": 1.058440060112341, "frac_models": 1.0, "mean_IC80": 5.098836079608522, "median_IC80": 7.318943205078734, "std_IC80": 4.233760240449364, "n_models": 3, "times_seen": null}, {"antibody": "3BNC117", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.011801, "MAP_fold_enrichment": "", "measured IC90": "0.086449", "measured IC80": 0.041454, "mean_IC50": 1.9432305455343164, "median_IC50": 2.0368561837985055, "std_IC50": 1.8435865405257092, "frac_models": 1.0, "mean_IC80": 7.772922182137272, "median_IC80": 8.147424735194027, "std_IC80": 7.374346162102843, "n_models": 3, "times_seen": 10.333333333333334}, {"antibody": "IDC508", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.027578, "MAP_fold_enrichment": "", "measured IC90": "0.128032", "measured IC80": 0.07265, "mean_IC50": 0.14370494866071576, "median_IC50": 0.14370494866071576, "std_IC50": 0.05674636241201011, "frac_models": 1.0, "mean_IC80": 0.574819794642863, "median_IC80": 0.574819794642863, "std_IC80": 0.22698544964804024, "n_models": 2, "times_seen": null}, {"antibody": "IDC508", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.071885, "MAP_fold_enrichment": "", "measured IC90": "0.282387", "measured IC80": 0.170428, "mean_IC50": 0.6129641618773465, "median_IC50": 0.6129641618773465, "std_IC50": 0.3011747041621459, "frac_models": 1.0, "mean_IC80": 2.4518566475093877, "median_IC80": 2.4518566475093877, "std_IC80": 1.2046988166485852, "n_models": 2, "times_seen": 8.5}, {"antibody": "IDC508", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.039933, "MAP_fold_enrichment": "", "measured IC90": "0.221738", "measured IC80": 0.117778, "mean_IC50": 0.19645562445351092, "median_IC50": 0.19645562445351092, "std_IC50": 0.08352736138489078, "frac_models": 1.0, "mean_IC80": 0.7858224978140438, "median_IC80": 0.7858224978140438, "std_IC80": 0.3341094455395633, "n_models": 2, "times_seen": 8.0}, {"antibody": "IDC508", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.016793, "MAP_fold_enrichment": "", "measured IC90": "0.140093", "measured IC80": 0.064032, "mean_IC50": 0.23634995427981148, "median_IC50": 0.23634995427981148, "std_IC50": 0.13616128523256094, "frac_models": 1.0, "mean_IC80": 0.9453998171192464, "median_IC80": 0.9453998171192464, "std_IC80": 0.5446451409302442, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDC508", "aa_substitutions": "N276D G459D", "max % neutralization": 100, "measured IC50": 0.062536, "MAP_fold_enrichment": "", "measured IC90": "0.233639", "measured IC80": 0.143642, "mean_IC50": 1.017691857842302, "median_IC50": 1.017691857842302, "std_IC50": 0.6742586497948119, "frac_models": 1.0, "mean_IC80": 4.070767431369208, "median_IC80": 4.070767431369208, "std_IC80": 2.697034599179246, "n_models": 2, "times_seen": null}, {"antibody": "IDC508", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.015866, "MAP_fold_enrichment": "", "measured IC90": "0.092614", "measured IC80": 0.048293, "mean_IC50": 0.16907483510587032, "median_IC50": 0.16907483510587032, "std_IC50": 0.04125646103184076, "frac_models": 1.0, "mean_IC80": 0.6762993404234815, "median_IC80": 0.6762993404234815, "std_IC80": 0.16502584412736304, "n_models": 2, "times_seen": 3.5}, {"antibody": "IDC508", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.025759, "MAP_fold_enrichment": "", "measured IC90": "0.198820", "measured IC80": 0.093518, "mean_IC50": 0.2200747424692628, "median_IC50": 0.2200747424692628, "std_IC50": 0.15812753344837224, "frac_models": 1.0, "mean_IC80": 0.8802989698770515, "median_IC80": 0.8802989698770515, "std_IC80": 0.632510133793489, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDC508", "aa_substitutions": "T198D G459D", "max % neutralization": 100, "measured IC50": 0.03086, "MAP_fold_enrichment": "", "measured IC90": "0.593408", "measured IC80": 0.199289, "mean_IC50": 0.9546059981793942, "median_IC50": 0.9546059981793942, "std_IC50": 0.7587563236303144, "frac_models": 1.0, "mean_IC80": 3.8184239927175776, "median_IC80": 3.8184239927175776, "std_IC80": 3.0350252945212586, "n_models": 2, "times_seen": null}, {"antibody": "IDC508", "aa_substitutions": "T198D N276D", "max % neutralization": 100, "measured IC50": 0.064728, "MAP_fold_enrichment": "", "measured IC90": "0.318888", "measured IC80": 0.177027, "mean_IC50": 0.37346619175040524, "median_IC50": 0.37346619175040524, "std_IC50": 0.321118010528575, "frac_models": 1.0, "mean_IC80": 1.4938647670016216, "median_IC80": 1.4938647670016216, "std_IC80": 1.2844720421143008, "n_models": 2, "times_seen": null}, {"antibody": "IDC508", "aa_substitutions": "T198D N276D G459D", "max % neutralization": 100, "measured IC50": 0.045997, "MAP_fold_enrichment": "", "measured IC90": "0.944841", "measured IC80": 0.309676, "mean_IC50": 1.6317388800691126, "median_IC50": 1.6317388800691126, "std_IC50": 1.5080702381645588, "frac_models": 1.0, "mean_IC80": 6.526955520276452, "median_IC80": 6.526955520276452, "std_IC80": 6.032280952658235, "n_models": 2, "times_seen": null}, {"antibody": "IDC508", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.028952, "MAP_fold_enrichment": "", "measured IC90": "0.230193", "measured IC80": 0.107096, "mean_IC50": 0.24490435155391654, "median_IC50": 0.24490435155391654, "std_IC50": 0.03206489919551436, "frac_models": 1.0, "mean_IC80": 0.9796174062156664, "median_IC80": 0.9796174062156664, "std_IC80": 0.12825959678205745, "n_models": 2, "times_seen": 9.5}, {"antibody": "IDC508", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.033261, "MAP_fold_enrichment": "", "measured IC90": "0.206739", "measured IC80": 0.105335, "mean_IC50": 0.2432891117409928, "median_IC50": 0.2432891117409928, "std_IC50": 0.07657578207636911, "frac_models": 1.0, "mean_IC80": 0.9731564469639715, "median_IC80": 0.9731564469639715, "std_IC80": 0.3063031283054763, "n_models": 2, "times_seen": 3.5}, {"antibody": "IDC513", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.337497, "MAP_fold_enrichment": "", "measured IC90": "1.368177", "measured IC80": 0.816196, "mean_IC50": 0.9039054134751078, "median_IC50": 0.9039054134751078, "std_IC50": 0.6298709068118872, "frac_models": 1.0, "mean_IC80": 3.6156216539004324, "median_IC80": 3.6156216539004324, "std_IC80": 2.5194836272475496, "n_models": 2, "times_seen": null}, {"antibody": "IDC513", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.552039, "MAP_fold_enrichment": "", "measured IC90": "3.256033", "measured IC80": 1.691372, "mean_IC50": 12.31354345565891, "median_IC50": 12.31354345565891, "std_IC50": 6.975156481806003, "frac_models": 1.0, "mean_IC80": 49.254173822635664, "median_IC80": 49.254173822635664, "std_IC80": 27.900625927224034, "n_models": 2, "times_seen": 8.0}, {"antibody": "IDC513", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.802481, "MAP_fold_enrichment": "", "measured IC90": "2.264337", "measured IC80": 1.54409, "mean_IC50": 5.198791949515596, "median_IC50": 5.198791949515596, "std_IC50": 5.135438758298202, "frac_models": 1.0, "mean_IC80": 20.795167798062387, "median_IC80": 20.795167798062387, "std_IC80": 20.54175503319281, "n_models": 2, "times_seen": 7.0}, {"antibody": "IDC513", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.046666, "MAP_fold_enrichment": "", "measured IC90": "0.287156", "measured IC80": 0.146852, "mean_IC50": 0.4362140724907243, "median_IC50": 0.4362140724907243, "std_IC50": 0.1037815817645659, "frac_models": 1.0, "mean_IC80": 1.7448562899628977, "median_IC80": 1.7448562899628977, "std_IC80": 0.4151263270582642, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDC513", "aa_substitutions": "N276D G459D", "max % neutralization": 100, "measured IC50": 0.187941, "MAP_fold_enrichment": "", "measured IC90": "1.538383", "measured IC80": 0.708088, "mean_IC50": 6.17713235087695, "median_IC50": 6.17713235087695, "std_IC50": 0.47547505567804227, "frac_models": 1.0, "mean_IC80": 24.70852940350781, "median_IC80": 24.70852940350781, "std_IC80": 1.901900222712178, "n_models": 2, "times_seen": null}, {"antibody": "IDC513", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.186853, "MAP_fold_enrichment": "", "measured IC90": "1.122398", "measured IC80": 0.579124, "mean_IC50": 1.2781037227659375, "median_IC50": 1.2781037227659375, "std_IC50": 1.1383852405048545, "frac_models": 1.0, "mean_IC80": 5.112414891063751, "median_IC80": 5.112414891063751, "std_IC80": 4.553540962019419, "n_models": 2, "times_seen": 3.0}, {"antibody": "IDC513", "aa_substitutions": "Q203P", "max % neutralization": 100, "measured IC50": 0.083944, "MAP_fold_enrichment": "", "measured IC90": "1.219105", "measured IC80": 0.454112, "mean_IC50": 1.0073684672765242, "median_IC50": 1.0073684672765242, "std_IC50": 0.6900730475668916, "frac_models": 1.0, "mean_IC80": 4.029473869106098, "median_IC80": 4.029473869106098, "std_IC80": 2.7602921902675672, "n_models": 2, "times_seen": 4.0}, {"antibody": "IDC513", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.308683, "MAP_fold_enrichment": "", "measured IC90": "1.832622", "measured IC80": 0.949675, "mean_IC50": 1.9764593680951938, "median_IC50": 1.9764593680951938, "std_IC50": 2.058482596723508, "frac_models": 1.0, "mean_IC80": 7.905837472380779, "median_IC80": 7.905837472380779, "std_IC80": 8.233930386894038, "n_models": 2, "times_seen": 6.5}, {"antibody": "IDC513", "aa_substitutions": "T198D G459D", "max % neutralization": 100, "measured IC50": 0.106177, "MAP_fold_enrichment": "", "measured IC90": "3.125000", "measured IC80": 1.351345, "mean_IC50": 26.12564129340915, "median_IC50": 26.12564129340915, "std_IC50": 25.088407005066244, "frac_models": 1.0, "mean_IC80": 104.50256517363665, "median_IC80": 104.50256517363665, "std_IC80": 100.35362802026505, "n_models": 2, "times_seen": null}, {"antibody": "IDC513", "aa_substitutions": "T198D N276D", "max % neutralization": 100, "measured IC50": 0.076627, "MAP_fold_enrichment": "", "measured IC90": "0.433407", "measured IC80": 0.228646, "mean_IC50": 0.8541945324169968, "median_IC50": 0.8541945324169968, "std_IC50": 0.6250951294592137, "frac_models": 1.0, "mean_IC80": 3.416778129667989, "median_IC80": 3.416778129667989, "std_IC80": 2.5003805178368563, "n_models": 2, "times_seen": null}, {"antibody": "IDC513", "aa_substitutions": "T198D N276D G459D", "max % neutralization": 100, "measured IC50": 0.080978, "MAP_fold_enrichment": "", "measured IC90": "3.125000", "measured IC80": 0.990427, "mean_IC50": 11.601329521169948, "median_IC50": 11.601329521169948, "std_IC50": 7.022788590125429, "frac_models": 1.0, "mean_IC80": 46.40531808467982, "median_IC80": 46.40531808467982, "std_IC80": 28.091154360501726, "n_models": 2, "times_seen": null}, {"antibody": "IDC513", "aa_substitutions": "T202P", "max % neutralization": 100, "measured IC50": 0.249794, "MAP_fold_enrichment": "", "measured IC90": "1.671103", "measured IC80": 0.828638, "mean_IC50": 1.2901436066010903, "median_IC50": 1.2901436066010903, "std_IC50": 0.9256041494418218, "frac_models": 1.0, "mean_IC80": 5.160574426404362, "median_IC80": 5.160574426404362, "std_IC80": 3.7024165977672867, "n_models": 2, "times_seen": 8.5}, {"antibody": "IDC513", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.331378, "MAP_fold_enrichment": "", "measured IC90": "1.817576", "measured IC80": 0.969812, "mean_IC50": 1.214970394567226, "median_IC50": 1.214970394567226, "std_IC50": 0.9288624954338184, "frac_models": 1.0, "mean_IC80": 4.859881578268904, "median_IC80": 4.859881578268904, "std_IC80": 3.7154499817352726, "n_models": 2, "times_seen": 4.0}, {"antibody": "IDC561", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.049447, "MAP_fold_enrichment": "", "measured IC90": "0.296411", "measured IC80": 0.153056, "mean_IC50": 0.09157469322318051, "median_IC50": 0.08323110246844842, "std_IC50": 0.020157978590530715, "frac_models": 1.0, "mean_IC80": 0.3662987728927221, "median_IC80": 0.3329244098737939, "std_IC80": 0.08063191436212278, "n_models": 3, "times_seen": null}, {"antibody": "IDC561", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.013112, "MAP_fold_enrichment": "", "measured IC90": "0.104547", "measured IC80": 0.048589, "mean_IC50": 0.08939492356594232, "median_IC50": 0.08205116601662524, "std_IC50": 0.01764425024712396, "frac_models": 1.0, "mean_IC80": 0.35757969426376945, "median_IC80": 0.32820466406650095, "std_IC80": 0.07057700098849587, "n_models": 3, "times_seen": 8.0}, {"antibody": "IDC561", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.073617, "MAP_fold_enrichment": "", "measured IC90": "0.361579", "measured IC80": 0.200952, "mean_IC50": 0.12988654946799474, "median_IC50": 0.11651472848804216, "std_IC50": 0.04457665279339992, "frac_models": 1.0, "mean_IC80": 0.5195461978719791, "median_IC80": 0.46605891395216875, "std_IC80": 0.1783066111735997, "n_models": 3, "times_seen": 7.666666666666667}, {"antibody": "IDC561", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.009251, "MAP_fold_enrichment": "", "measured IC90": "0.053783", "measured IC80": 0.028087, "mean_IC50": 0.08535888032233498, "median_IC50": 0.07770920277095138, "std_IC50": 0.01580924337005506, "frac_models": 1.0, "mean_IC80": 0.34143552128934007, "median_IC80": 0.3108368110838055, "std_IC80": 0.06323697348022043, "n_models": 3, "times_seen": 5.666666666666667}, {"antibody": "IDC561", "aa_substitutions": "N276D G459D", "max % neutralization": 100, "measured IC50": 0.006227, "MAP_fold_enrichment": "", "measured IC90": "0.039255", "measured IC80": 0.019897, "mean_IC50": 0.08336980803327876, "median_IC50": 0.07660754824190884, "std_IC50": 0.013561805730838693, "frac_models": 1.0, "mean_IC80": 0.3334792321331152, "median_IC80": 0.3064301929676354, "std_IC80": 0.054247222923354814, "n_models": 3, "times_seen": null}, {"antibody": "IDC561", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.071085, "MAP_fold_enrichment": "", "measured IC90": "0.377252", "measured IC80": 0.203756, "mean_IC50": 0.47467219527226884, "median_IC50": 0.2908474481798491, "std_IC50": 0.34976708598154105, "frac_models": 1.0, "mean_IC80": 1.8986887810890754, "median_IC80": 1.1633897927193964, "std_IC80": 1.399068343926164, "n_models": 3, "times_seen": 4.666666666666667}, {"antibody": "IDC561", "aa_substitutions": "T198D G459D", "max % neutralization": 100, "measured IC50": 0.015788, "MAP_fold_enrichment": "", "measured IC90": "0.134359", "measured IC80": 0.060962, "mean_IC50": 0.46637901025036016, "median_IC50": 0.2896396721622352, "std_IC50": 0.34646852583529786, "frac_models": 1.0, "mean_IC80": 1.8655160410014409, "median_IC80": 1.1585586886489407, "std_IC80": 1.3858741033411914, "n_models": 3, "times_seen": null}, {"antibody": "IDC561", "aa_substitutions": "T198D N276D", "max % neutralization": 100, "measured IC50": 0.020535, "MAP_fold_enrichment": "", "measured IC90": "0.128468", "measured IC80": 0.065299, "mean_IC50": 0.44442418513649146, "median_IC50": 0.282913142837756, "std_IC50": 0.32611054073710477, "frac_models": 1.0, "mean_IC80": 1.7776967405459663, "median_IC80": 1.1316525713510242, "std_IC80": 1.304442162948419, "n_models": 3, "times_seen": null}, {"antibody": "IDC561", "aa_substitutions": "T198D N276D G459D", "max % neutralization": 100, "measured IC50": 0.007521, "MAP_fold_enrichment": "", "measured IC90": "0.048712", "measured IC80": 0.024444, "mean_IC50": 0.4367773716200188, "median_IC50": 0.28173831489573475, "std_IC50": 0.32307402698342313, "frac_models": 1.0, "mean_IC80": 1.7471094864800756, "median_IC80": 1.1269532595829397, "std_IC80": 1.2922961079336923, "n_models": 3, "times_seen": null}, {"antibody": "IDC561", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.040781, "MAP_fold_enrichment": "", "measured IC90": "0.269964", "measured IC80": 0.134386, "mean_IC50": 0.27302003710544964, "median_IC50": 0.25210686381445324, "std_IC50": 0.04094406900338314, "frac_models": 1.0, "mean_IC80": 1.0920801484217986, "median_IC80": 1.0084274552578132, "std_IC80": 0.16377627601353245, "n_models": 3, "times_seen": 4.0}, {"antibody": "IDF033", "aa_substitutions": "", "max % neutralization": 100, "measured IC50": 0.06021, "MAP_fold_enrichment": "", "measured IC90": "0.215510", "measured IC80": 0.13461, "mean_IC50": 0.1591945142978397, "median_IC50": 0.1591945142978397, "std_IC50": 0.03902752035936558, "frac_models": 1.0, "mean_IC80": 0.6367780571913589, "median_IC80": 0.6367780571913589, "std_IC80": 0.15611008143746216, "n_models": 2, "times_seen": null}, {"antibody": "IDF033", "aa_substitutions": "G459D", "max % neutralization": 100, "measured IC50": 0.08697, "MAP_fold_enrichment": "", "measured IC90": "0.440192", "measured IC80": 0.241945, "mean_IC50": 0.9800189379935189, "median_IC50": 0.9800189379935189, "std_IC50": 0.07180982154713121, "frac_models": 1.0, "mean_IC80": 3.9200757519740765, "median_IC80": 3.9200757519740765, "std_IC80": 0.2872392861885253, "n_models": 2, "times_seen": 8.5}, {"antibody": "IDF033", "aa_substitutions": "G471H", "max % neutralization": 100, "measured IC50": 0.06644, "MAP_fold_enrichment": "", "measured IC90": "0.403075", "measured IC80": 0.207215, "mean_IC50": 0.1897988904788384, "median_IC50": 0.1897988904788384, "std_IC50": 0.07209835878025393, "frac_models": 1.0, "mean_IC80": 0.7591955619153541, "median_IC80": 0.7591955619153541, "std_IC80": 0.28839343512101584, "n_models": 2, "times_seen": 8.0}, {"antibody": "IDF033", "aa_substitutions": "N276D", "max % neutralization": 100, "measured IC50": 0.172088, "MAP_fold_enrichment": "", "measured IC90": "0.655129", "measured IC80": 0.399994, "mean_IC50": 1.2480072334633763, "median_IC50": 1.2480072334633763, "std_IC50": 0.21169558961075458, "frac_models": 1.0, "mean_IC80": 4.992028933853504, "median_IC80": 4.992028933853504, "std_IC80": 0.8467823584430174, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDF033", "aa_substitutions": "N276D G459D", "max % neutralization": 100, "measured IC50": 0.160855, "MAP_fold_enrichment": "", "measured IC90": "0.943497", "measured IC80": 0.491114, "mean_IC50": 7.96522551516278, "median_IC50": 7.96522551516278, "std_IC50": 2.6929917342602865, "frac_models": 1.0, "mean_IC80": 31.860902060651135, "median_IC80": 31.860902060651135, "std_IC80": 10.771966937041157, "n_models": 2, "times_seen": null}, {"antibody": "IDF033", "aa_substitutions": "N463S", "max % neutralization": 100, "measured IC50": 0.075948, "MAP_fold_enrichment": "", "measured IC90": "0.248057", "measured IC80": 0.160264, "mean_IC50": 0.3520537086182483, "median_IC50": 0.3520537086182483, "std_IC50": 0.2872423181812376, "frac_models": 1.0, "mean_IC80": 1.4082148344729937, "median_IC80": 1.4082148344729937, "std_IC80": 1.1489692727249503, "n_models": 2, "times_seen": 3.0}, {"antibody": "IDF033", "aa_substitutions": "T198D", "max % neutralization": 100, "measured IC50": 0.030449, "MAP_fold_enrichment": "", "measured IC90": "0.250743", "measured IC80": 0.115156, "mean_IC50": 0.16149359767254168, "median_IC50": 0.16149359767254168, "std_IC50": 0.04429117035649022, "frac_models": 1.0, "mean_IC80": 0.6459743906901667, "median_IC80": 0.6459743906901667, "std_IC80": 0.17716468142596065, "n_models": 2, "times_seen": 6.0}, {"antibody": "IDF033", "aa_substitutions": "T198D G459D", "max % neutralization": 100, "measured IC50": 0.060471, "MAP_fold_enrichment": "", "measured IC90": "0.447779", "measured IC80": 0.213871, "mean_IC50": 0.9916087038400635, "median_IC50": 0.9916087038400635, "std_IC50": 0.10240920272531037, "frac_models": 1.0, "mean_IC80": 3.9664348153602544, "median_IC80": 3.9664348153602544, "std_IC80": 0.40963681090124215, "n_models": 2, "times_seen": null}, {"antibody": "IDF033", "aa_substitutions": "T198D N276D", "max % neutralization": 100, "measured IC50": 0.166945, "MAP_fold_enrichment": "", "measured IC90": "0.655979", "measured IC80": 0.395863, "mean_IC50": 1.258152663723133, "median_IC50": 1.258152663723133, "std_IC50": 0.17597566232982303, "frac_models": 1.0, "mean_IC80": 5.032610654892533, "median_IC80": 5.032610654892533, "std_IC80": 0.7039026493192944, "n_models": 2, "times_seen": null}, {"antibody": "IDF033", "aa_substitutions": "T198D N276D G459D", "max % neutralization": 100, "measured IC50": 0.146342, "MAP_fold_enrichment": "", "measured IC90": "1.700309", "measured IC80": 0.687717, "mean_IC50": 8.009554969541174, "median_IC50": 8.009554969541174, "std_IC50": 2.4793871499424927, "frac_models": 1.0, "mean_IC80": 32.038219878164696, "median_IC80": 32.038219878164696, "std_IC80": 9.917548599769962, "n_models": 2, "times_seen": null}, {"antibody": "IDF033", "aa_substitutions": "V164F", "max % neutralization": 100, "measured IC50": 0.042198, "MAP_fold_enrichment": "", "measured IC90": "0.298770", "measured IC80": 0.145081, "mean_IC50": 0.16849724927195683, "median_IC50": 0.16849724927195683, "std_IC50": 0.04286932249918226, "frac_models": 1.0, "mean_IC80": 0.6739889970878276, "median_IC80": 0.6739889970878276, "std_IC80": 0.17147728999672887, "n_models": 2, "times_seen": 3.5}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody!=&quot;PGT151&quot;&#39;</span><span class="p">)</span>

<span class="n">fold_change_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">&quot;measured_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;measured fold change IC80&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;predicted fold change IC80&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Amino acid substitutions&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;tableau20&quot;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">plot_data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">antibody</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;antibody&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;antibody==@antibody&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted fold change correlation (R^2): </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fold_change_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1-18:
Predicted fold change correlation (R^2): 0.066
3BNC117:
Predicted fold change correlation (R^2): 0.636
IDC508:
Predicted fold change correlation (R^2): 0.793
IDC513:
Predicted fold change correlation (R^2): 0.371
IDC561:
Predicted fold change correlation (R^2): 0.014
IDF033:
Predicted fold change correlation (R^2): 0.766
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-cd2929842c994c9f8514829c1ce25981"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-cd2929842c994c9f8514829c1ce25981") {
      outputDiv = document.getElementById("altair-viz-cd2929842c994c9f8514829c1ce25981");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-7bba4fd95e9aa98ccf1860cc25d61983"}, "mark": {"type": "circle", "filled": true, "opacity": 1, "size": 60}, "encoding": {"color": {"field": "aa_substitutions", "scale": {"scheme": "tableau20"}, "title": "Amino acid substitutions", "type": "nominal"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "measured IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "type": "nominal"}, {"field": "predicted IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "measured IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "measured_fold_change", "format": ".3g", "type": "quantitative"}, {"field": "predicted_fold_change", "format": ".3g", "type": "quantitative"}], "x": {"field": "measured_fold_change", "scale": {"nice": false, "type": "log"}, "title": "measured fold change IC80", "type": "quantitative"}, "y": {"field": "predicted_fold_change", "scale": {"nice": false, "type": "log"}, "title": "predicted fold change IC80", "type": "quantitative"}}, "height": 150, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-7bba4fd95e9aa98ccf1860cc25d61983": [{"antibody": "1-18", "aa_substitutions": "", "measured IC80 mutant": 0.040739, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.5928805637529398, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "1-18", "aa_substitutions": "G459D", "measured IC80 mutant": 0.016877, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.560894386325758, "max % neutralization": 100, "times_seen": 7.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.41427133704803754, "predicted_fold_change": 0.9460495428881848}, {"antibody": "1-18", "aa_substitutions": "N276D", "measured IC80 mutant": 0.007466, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.48201662977973075, "max % neutralization": 100, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.18326419401556251, "predicted_fold_change": 0.8130079804413906}, {"antibody": "1-18", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.004369, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.4560116122676177, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.10724367313876138, "predicted_fold_change": 0.769145828261024}, {"antibody": "1-18", "aa_substitutions": "N463S", "measured IC80 mutant": 0.052213, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7703344937833605, "max % neutralization": 100, "times_seen": 3.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 1.2816465794447582, "predicted_fold_change": 1.299308057776655}, {"antibody": "1-18", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.093217, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.8085139447812095, "max % neutralization": 100, "times_seen": 2.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 2.2881514028326664, "predicted_fold_change": 1.3637045877559355}, {"antibody": "1-18", "aa_substitutions": "R476M", "measured IC80 mutant": 0.030902, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.6984507994771518, "max % neutralization": 100, "times_seen": 9.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.7585360465401704, "predicted_fold_change": 2.8647435981472245}, {"antibody": "1-18", "aa_substitutions": "T198D", "measured IC80 mutant": 0.07192, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.320356757995779, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 1.7653845209749872, "predicted_fold_change": 7.287060872172766}, {"antibody": "1-18", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.016986, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.5124845226044616, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.41694690591325273, "predicted_fold_change": 5.924438643038658}, {"antibody": "1-18", "aa_substitutions": "T202P", "measured IC80 mutant": 0.029633, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6075224311578883, "max % neutralization": 100, "times_seen": 9.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.040739, "predicted IC80 unmutated": 0.5928805637529398, "measured_fold_change": 0.7273865337882619, "predicted_fold_change": 1.0246961501187781}, {"antibody": "3BNC117", "aa_substitutions": "", "measured IC80 mutant": 0.018801, "MAP_fold_enrichment": "", "predicted IC80 mutant": 6.778359351889197, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "3BNC117", "aa_substitutions": "G459D", "measured IC80 mutant": 0.025188, "MAP_fold_enrichment": "", "predicted IC80 mutant": 10.399701658999135, "max % neutralization": 100, "times_seen": 8.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 1.3397159725546515, "predicted_fold_change": 1.5342505640543582}, {"antibody": "3BNC117", "aa_substitutions": "N276D", "measured IC80 mutant": 0.006859, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.9413209635375945, "max % neutralization": 100, "times_seen": 7.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.3648210201585022, "predicted_fold_change": 0.28639982962787724}, {"antibody": "3BNC117", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.006653, "MAP_fold_enrichment": "", "predicted IC80 mutant": 2.978472783318105, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.3538641561619063, "predicted_fold_change": 0.43940910015164286}, {"antibody": "3BNC117", "aa_substitutions": "N463S", "measured IC80 mutant": 0.03609, "MAP_fold_enrichment": "", "predicted IC80 mutant": 15.475266449265014, "max % neutralization": 100, "times_seen": 3.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 1.919578745811393, "predicted_fold_change": 2.2830401349187692}, {"antibody": "3BNC117", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.017207, "MAP_fold_enrichment": "", "predicted IC80 mutant": 7.756825548255446, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.9152172756768258, "predicted_fold_change": 1.1443514788122793}, {"antibody": "3BNC117", "aa_substitutions": "R476M", "measured IC80 mutant": 0.005776, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.652435600338958, "max % neutralization": 100, "times_seen": 9.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.30721770118610714, "predicted_fold_change": 0.5388377055165994}, {"antibody": "3BNC117", "aa_substitutions": "T198D", "measured IC80 mutant": 0.041971, "MAP_fold_enrichment": "", "predicted IC80 mutant": 25.554984493490544, "max % neutralization": 100, "times_seen": 7.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 2.232381256316154, "predicted_fold_change": 3.7700840523257466}, {"antibody": "3BNC117", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.009615, "MAP_fold_enrichment": "", "predicted IC80 mutant": 7.318943205078734, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 0.5114089676081061, "predicted_fold_change": 1.0797514302688704}, {"antibody": "3BNC117", "aa_substitutions": "T202P", "measured IC80 mutant": 0.041454, "MAP_fold_enrichment": "", "predicted IC80 mutant": 8.147424735194027, "max % neutralization": 100, "times_seen": 10.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.018801, "predicted IC80 unmutated": 6.778359351889197, "measured_fold_change": 2.2048827190043085, "predicted_fold_change": 1.2019759225251547}, {"antibody": "IDC508", "aa_substitutions": "", "measured IC80 mutant": 0.07265, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.574819794642863, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC508", "aa_substitutions": "G459D", "measured IC80 mutant": 0.170428, "MAP_fold_enrichment": "", "predicted IC80 mutant": 2.4518566475093877, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.3458774948382652, "predicted_fold_change": 4.26543530748229}, {"antibody": "IDC508", "aa_substitutions": "G471H", "measured IC80 mutant": 0.117778, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7858224978140438, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.6211699931176873, "predicted_fold_change": 1.3670762648357948}, {"antibody": "IDC508", "aa_substitutions": "N276D", "measured IC80 mutant": 0.064032, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9453998171192464, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 0.8813764624913971, "predicted_fold_change": 1.644689041557147}, {"antibody": "IDC508", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.143642, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.070767431369208, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.9771782518926357, "predicted_fold_change": 7.0818149780286985}, {"antibody": "IDC508", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.048293, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6762993404234815, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 0.664735030970406, "predicted_fold_change": 1.1765414947891069}, {"antibody": "IDC508", "aa_substitutions": "T198D", "measured IC80 mutant": 0.093518, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.8802989698770515, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.2872401927047488, "predicted_fold_change": 1.5314346828017351}, {"antibody": "IDC508", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 0.199289, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.8184239927175776, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.7431383344803852, "predicted_fold_change": 6.6428192423157135}, {"antibody": "IDC508", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.177027, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.4938647670016216, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.4367102546455603, "predicted_fold_change": 2.598840159862211}, {"antibody": "IDC508", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.309676, "MAP_fold_enrichment": "", "predicted IC80 mutant": 6.526955520276452, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 4.262573984858912, "predicted_fold_change": 11.35478558864116}, {"antibody": "IDC508", "aa_substitutions": "T202P", "measured IC80 mutant": 0.107096, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9796174062156664, "max % neutralization": 100, "times_seen": 9.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.4741362697866482, "predicted_fold_change": 1.7042165481171454}, {"antibody": "IDC508", "aa_substitutions": "V164F", "measured IC80 mutant": 0.105335, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9731564469639715, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.4498967653131452, "predicted_fold_change": 1.6929765746299603}, {"antibody": "IDC513", "aa_substitutions": "", "measured IC80 mutant": 0.816196, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.6156216539004324, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC513", "aa_substitutions": "G459D", "measured IC80 mutant": 1.691372, "MAP_fold_enrichment": "", "predicted IC80 mutant": 49.254173822635664, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 2.0722620547025468, "predicted_fold_change": 13.622601736965931}, {"antibody": "IDC513", "aa_substitutions": "G471H", "measured IC80 mutant": 1.54409, "MAP_fold_enrichment": "", "predicted IC80 mutant": 20.795167798062387, "max % neutralization": 100, "times_seen": 7.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.8918127508588622, "predicted_fold_change": 5.751477833868247}, {"antibody": "IDC513", "aa_substitutions": "N276D", "measured IC80 mutant": 0.146852, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.7448562899628977, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.17992246960288952, "predicted_fold_change": 0.4825881845465205}, {"antibody": "IDC513", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.708088, "MAP_fold_enrichment": "", "predicted IC80 mutant": 24.70852940350781, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.8675465206886581, "predicted_fold_change": 6.833826038422171}, {"antibody": "IDC513", "aa_substitutions": "N463S", "measured IC80 mutant": 0.579124, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.112414891063751, "max % neutralization": 100, "times_seen": 3.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.7095403555028449, "predicted_fold_change": 1.4139794979788938}, {"antibody": "IDC513", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.454112, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.029473869106098, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.5563761645487113, "predicted_fold_change": 1.1144622570669729}, {"antibody": "IDC513", "aa_substitutions": "T198D", "measured IC80 mutant": 0.949675, "MAP_fold_enrichment": "", "predicted IC80 mutant": 7.905837472380779, "max % neutralization": 100, "times_seen": 6.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.1635379247141617, "predicted_fold_change": 2.186577642561738}, {"antibody": "IDC513", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 1.351345, "MAP_fold_enrichment": "", "predicted IC80 mutant": 104.50256517363665, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.6556623654122293, "predicted_fold_change": 28.90306983887603}, {"antibody": "IDC513", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.228646, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.416778129667989, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.2801361437693887, "predicted_fold_change": 0.945004333067334}, {"antibody": "IDC513", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.990427, "MAP_fold_enrichment": "", "predicted IC80 mutant": 46.40531808467982, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.2134671083906317, "predicted_fold_change": 12.834672022339243}, {"antibody": "IDC513", "aa_substitutions": "T202P", "measured IC80 mutant": 0.828638, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.160574426404362, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.0152438874976109, "predicted_fold_change": 1.4272993472193856}, {"antibody": "IDC513", "aa_substitutions": "V164F", "measured IC80 mutant": 0.969812, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.859881578268904, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.1882096947301872, "predicted_fold_change": 1.344134437580381}, {"antibody": "IDC561", "aa_substitutions": "", "measured IC80 mutant": 0.153056, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3329244098737939, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC561", "aa_substitutions": "G459D", "measured IC80 mutant": 0.048589, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.32820466406650095, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.31745896926615097, "predicted_fold_change": 0.98582337110973}, {"antibody": "IDC561", "aa_substitutions": "G471H", "measured IC80 mutant": 0.200952, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.46605891395216875, "max % neutralization": 100, "times_seen": 7.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.3129312147187957, "predicted_fold_change": 1.3998940904598853}, {"antibody": "IDC561", "aa_substitutions": "N276D", "measured IC80 mutant": 0.028087, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3108368110838055, "max % neutralization": 100, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.18350799707296678, "predicted_fold_change": 0.9336558145485294}, {"antibody": "IDC561", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.019897, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3064301929676354, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.1299981706042233, "predicted_fold_change": 0.920419722554432}, {"antibody": "IDC561", "aa_substitutions": "T198D", "measured IC80 mutant": 0.203756, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1633897927193964, "max % neutralization": 100, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.331251306711269, "predicted_fold_change": 3.4944562736040234}, {"antibody": "IDC561", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 0.060962, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1585586886489407, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.3982986619276605, "predicted_fold_change": 3.4799451595878206}, {"antibody": "IDC561", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.065299, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1316525713510242, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.42663469579761654, "predicted_fold_change": 3.3991276631834078}, {"antibody": "IDC561", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.024444, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1269532595829397, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.15970625130671126, "predicted_fold_change": 3.3850124117067564}, {"antibody": "IDC561", "aa_substitutions": "V164F", "measured IC80 mutant": 0.134386, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.0084274552578132, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.8780185030315701, "predicted_fold_change": 3.0289982511047815}, {"antibody": "IDF033", "aa_substitutions": "", "measured IC80 mutant": 0.13461, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6367780571913589, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDF033", "aa_substitutions": "G459D", "measured IC80 mutant": 0.241945, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.9200757519740765, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.7973776093900897, "predicted_fold_change": 6.156109978513361}, {"antibody": "IDF033", "aa_substitutions": "G471H", "measured IC80 mutant": 0.207215, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7591955619153541, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.5393730034915682, "predicted_fold_change": 1.1922451682206872}, {"antibody": "IDF033", "aa_substitutions": "N276D", "measured IC80 mutant": 0.399994, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.992028933853504, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 2.9715028601144047, "predicted_fold_change": 7.839511549552882}, {"antibody": "IDF033", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.491114, "MAP_fold_enrichment": "", "predicted IC80 mutant": 31.860902060651135, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 3.6484213654260453, "predicted_fold_change": 50.03454767455433}, {"antibody": "IDF033", "aa_substitutions": "N463S", "measured IC80 mutant": 0.160264, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.4082148344729937, "max % neutralization": 100, "times_seen": 3.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.1905801946363568, "predicted_fold_change": 2.211468844708965}, {"antibody": "IDF033", "aa_substitutions": "T198D", "measured IC80 mutant": 0.115156, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6459743906901667, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 0.8554787905801946, "predicted_fold_change": 1.0144419761248842}, {"antibody": "IDF033", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 0.213871, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.9664348153602544, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.5888195527821112, "predicted_fold_change": 6.228912523862763}, {"antibody": "IDF033", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.395863, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.032610654892533, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 2.940814203996731, "predicted_fold_change": 7.903241322557347}, {"antibody": "IDF033", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.687717, "MAP_fold_enrichment": "", "predicted IC80 mutant": 32.038219878164696, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 5.108959215511478, "predicted_fold_change": 50.31300861633939}, {"antibody": "IDF033", "aa_substitutions": "V164F", "measured IC80 mutant": 0.145081, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6739889970878276, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.0777876829358888, "predicted_fold_change": 1.0584362785058818}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<p>The following cells produce figures for the paper:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figure for paper</span>
<span class="n">PGT151_fold_changes</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody==&quot;PGT151&quot;&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;median_IC50&quot;</span><span class="p">:</span> <span class="s2">&quot;predicted IC50&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;aa_substitutions != &#39;&#39;&quot;</span><span class="p">)</span>
    <span class="p">[[</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span>
      <span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
      <span class="s2">&quot;measured IC50&quot;</span><span class="p">,</span>
      <span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">,</span>
      <span class="s2">&quot;predicted IC50&quot;</span><span class="p">,</span>
      <span class="s2">&quot;max % neutralization&quot;</span><span class="p">,</span>
      <span class="s2">&quot;times_seen&quot;</span><span class="p">,</span>
      <span class="s2">&quot;frac_models&quot;</span><span class="p">,</span>
      <span class="s2">&quot;n_models&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">validation_vs_prediction</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody==&quot;PGT151&quot;&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;median_IC50&quot;</span><span class="p">:</span> <span class="s2">&quot;predicted IC50&quot;</span><span class="p">})</span>
        <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;aa_substitutions == &#39;&#39;&quot;</span><span class="p">)</span>
        <span class="p">[[</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="s2">&quot;measured IC50&quot;</span><span class="p">,</span> <span class="s2">&quot;predicted IC50&quot;</span><span class="p">]],</span>
        <span class="n">on</span><span class="o">=</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;many_to_one&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot; mutant&quot;</span><span class="p">,</span> <span class="s2">&quot; unmutated&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">measured_fold_change</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;measured IC50 mutant&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;measured IC50 unmutated&quot;</span><span class="p">],</span>
        <span class="n">predicted_fold_change</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;predicted IC50 mutant&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;predicted IC50 unmutated&quot;</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">antibody_df</span> <span class="o">=</span> <span class="n">PGT151_fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;antibody==&#39;PGT151&#39;&quot;</span><span class="p">)</span>
<span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PGT151&quot;</span><span class="p">)</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
    <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
    <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAP fold change correlation: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">corr_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">antibody_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">&quot;measured_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;measured fold change IC50&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span>
        <span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;max % neutralization&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;max % neutralization&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;yelloworangered&#39;</span><span class="p">)),</span>        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">antibody_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">antibody_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">corr_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PGT151
MAP fold change correlation: 0.303
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-3b6dda211e4d432483cecd550818c9ff"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3b6dda211e4d432483cecd550818c9ff") {
      outputDiv = document.getElementById("altair-viz-3b6dda211e4d432483cecd550818c9ff");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-5b48bd2eb25c31aa4eafcbb2ae91f151"}, "mark": {"type": "circle", "filled": true, "opacity": 0.6, "size": 60}, "encoding": {"color": {"field": "max % neutralization", "scale": {"scheme": "yelloworangered"}, "title": "max % neutralization", "type": "quantitative"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "measured IC50 mutant", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC50 mutant", "format": ".3g", "type": "quantitative"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "measured IC50 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC50 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "measured_fold_change", "format": ".3g", "type": "quantitative"}, {"field": "predicted_fold_change", "format": ".3g", "type": "quantitative"}], "x": {"field": "measured_fold_change", "scale": {"domain": [0.4, 20], "type": "log"}, "title": "measured fold change IC50", "type": "quantitative"}, "y": {"field": "MAP_fold_enrichment", "scale": {"domain": [0.4, 50], "type": "log"}, "type": "quantitative"}}, "height": 150, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-5b48bd2eb25c31aa4eafcbb2ae91f151": [{"antibody": "PGT151", "aa_substitutions": "E647G", "measured IC50 mutant": 0.114, "MAP_fold_enrichment": 5.3, "predicted IC50 mutant": 0.5309527265954268, "max % neutralization": 74, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.7538461538461538, "predicted_fold_change": 4.050010636736031}, {"antibody": "PGT151", "aa_substitutions": "E648A", "measured IC50 mutant": 0.061, "MAP_fold_enrichment": 1.2, "predicted IC50 mutant": 0.13225716218819142, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.9384615384615385, "predicted_fold_change": 1.0088335303998632}, {"antibody": "PGT151", "aa_substitutions": "E648D", "measured IC50 mutant": 0.072, "MAP_fold_enrichment": 0.7, "predicted IC50 mutant": 0.12981774852368913, "max % neutralization": 98, "times_seen": 10.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.1076923076923075, "predicted_fold_change": 0.9902261275299622}, {"antibody": "PGT151", "aa_substitutions": "E648H", "measured IC50 mutant": 0.07, "MAP_fold_enrichment": 1.5, "predicted IC50 mutant": 0.20271880060498693, "max % neutralization": 100, "times_seen": 4.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.076923076923077, "predicted_fold_change": 1.5463020671935641}, {"antibody": "PGT151", "aa_substitutions": "E648K", "measured IC50 mutant": 0.731695719, "MAP_fold_enrichment": 7.7, "predicted IC50 mutant": 3.841115478091802, "max % neutralization": 74, "times_seen": 9.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 11.256857215384615, "predicted_fold_change": 29.299328855423564}, {"antibody": "PGT151", "aa_substitutions": "E648R", "measured IC50 mutant": 0.584, "MAP_fold_enrichment": 3.7, "predicted IC50 mutant": 1.1234128067939462, "max % neutralization": 100, "times_seen": 3.3333333333333335, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 8.984615384615383, "predicted_fold_change": 8.569188157551032}, {"antibody": "PGT151", "aa_substitutions": "I641A", "measured IC50 mutant": 0.095, "MAP_fold_enrichment": 1.4, "predicted IC50 mutant": 0.1358151824246827, "max % neutralization": 100, "times_seen": 6.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4615384615384615, "predicted_fold_change": 1.0359734603441195}, {"antibody": "PGT151", "aa_substitutions": "I641E", "measured IC50 mutant": 0.099, "MAP_fold_enrichment": 1.2, "predicted IC50 mutant": 0.13097626246435232, "max % neutralization": 98, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.523076923076923, "predicted_fold_change": 0.9990630607397771}, {"antibody": "PGT151", "aa_substitutions": "I641K", "measured IC50 mutant": 0.43, "MAP_fold_enrichment": 5.7, "predicted IC50 mutant": 1.7157224727537213, "max % neutralization": 91, "times_seen": 11.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 6.615384615384615, "predicted_fold_change": 13.08721834596464}, {"antibody": "PGT151", "aa_substitutions": "I641R", "measured IC50 mutant": 0.173, "MAP_fold_enrichment": 3.2, "predicted IC50 mutant": 0.1418626044267341, "max % neutralization": 92, "times_seen": 2.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 2.6615384615384614, "predicted_fold_change": 1.0821020932832286}, {"antibody": "PGT151", "aa_substitutions": "L645A", "measured IC50 mutant": 0.128, "MAP_fold_enrichment": 0.7, "predicted IC50 mutant": 0.14266030039583172, "max % neutralization": 96, "times_seen": 1.0, "frac_models": 0.6666666666666666, "n_models": 2, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.9692307692307691, "predicted_fold_change": 1.0881867727620262}, {"antibody": "PGT151", "aa_substitutions": "L645K", "measured IC50 mutant": 0.466, "MAP_fold_enrichment": 3.8, "predicted IC50 mutant": 1.9258593313311503, "max % neutralization": 90, "times_seen": 10.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 7.1692307692307695, "predicted_fold_change": 14.690104007492408}, {"antibody": "PGT151", "aa_substitutions": "L645R", "measured IC50 mutant": 0.214, "MAP_fold_enrichment": 3.7, "predicted IC50 mutant": 0.13769802832905456, "max % neutralization": 93, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 3.292307692307692, "predicted_fold_change": 1.050335465769607}, {"antibody": "PGT151", "aa_substitutions": "N611S", "measured IC50 mutant": 0.187, "MAP_fold_enrichment": 5.4, "predicted IC50 mutant": 0.5134628072788332, "max % neutralization": 98, "times_seen": 3.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 2.876923076923077, "predicted_fold_change": 3.916600719581895}, {"antibody": "PGT151", "aa_substitutions": "N637A", "measured IC50 mutant": 0.046, "MAP_fold_enrichment": 1.0, "predicted IC50 mutant": 0.1309300901646724, "max % neutralization": 81, "times_seen": 1.3333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7076923076923076, "predicted_fold_change": 0.9987108668523377}, {"antibody": "PGT151", "aa_substitutions": "N637G", "measured IC50 mutant": 0.049, "MAP_fold_enrichment": 2.8, "predicted IC50 mutant": 0.1309921828913152, "max % neutralization": 80, "times_seen": 1.6666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7538461538461538, "predicted_fold_change": 0.9991844988552842}, {"antibody": "PGT151", "aa_substitutions": "N637K", "measured IC50 mutant": 0.092, "MAP_fold_enrichment": 3.7, "predicted IC50 mutant": 0.44872909828349994, "max % neutralization": 59, "times_seen": 9.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4153846153846152, "predicted_fold_change": 3.4228237845474436}, {"antibody": "PGT151", "aa_substitutions": "Q640R", "measured IC50 mutant": 0.092, "MAP_fold_enrichment": 2.6, "predicted IC50 mutant": 0.22306084707377222, "max % neutralization": 98, "times_seen": 16.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4153846153846152, "predicted_fold_change": 1.7014674904880844}, {"antibody": "PGT151", "aa_substitutions": "S612P", "measured IC50 mutant": 0.15, "MAP_fold_enrichment": 8.0, "predicted IC50 mutant": 0.7095918319916776, "max % neutralization": 81, "times_seen": 2.3333333333333335, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 2.3076923076923075, "predicted_fold_change": 5.412637177202236}, {"antibody": "PGT151", "aa_substitutions": "T639A", "measured IC50 mutant": 0.049, "MAP_fold_enrichment": 1.4, "predicted IC50 mutant": 0.1335279657483853, "max % neutralization": 78, "times_seen": 9.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7538461538461538, "predicted_fold_change": 1.0185269883636057}, {"antibody": "PGT151", "aa_substitutions": "T639K", "measured IC50 mutant": 0.041, "MAP_fold_enrichment": 4.8, "predicted IC50 mutant": 0.2843250001992073, "max % neutralization": 74, "times_seen": 8.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.6307692307692307, "predicted_fold_change": 2.168779285644754}, {"antibody": "PGT151", "aa_substitutions": "T639R", "measured IC50 mutant": 0.042, "MAP_fold_enrichment": 2.8, "predicted IC50 mutant": 0.13341649302344424, "max % neutralization": 79, "times_seen": 4.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.6461538461538462, "predicted_fold_change": 1.0176766947327356}, {"antibody": "PGT151", "aa_substitutions": "T644A", "measured IC50 mutant": 0.052, "MAP_fold_enrichment": 1.0, "predicted IC50 mutant": 0.12509522182723598, "max % neutralization": 96, "times_seen": 8.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7999999999999999, "predicted_fold_change": 0.9542035545307677}, {"antibody": "PGT151", "aa_substitutions": "T644R", "measured IC50 mutant": 0.094, "MAP_fold_enrichment": 4.0, "predicted IC50 mutant": 0.3182981140725838, "max % neutralization": 87, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4461538461538461, "predicted_fold_change": 2.4279200069524354}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figure for paper</span>
<span class="n">antibody_df</span> <span class="o">=</span> <span class="n">PGT151_fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;antibody==&#39;PGT151&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;aa_substitutions!=&#39;&#39;&quot;</span><span class="p">)</span>
<span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;MAP_fold_enrichment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PGT151&quot;</span><span class="p">)</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
    <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
    <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAP fold change correlation: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">corr_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">antibody_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">&quot;measured_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;measured fold change IC50&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span>
        <span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;max % neutralization&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;max % neutralization&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;yelloworangered&#39;</span><span class="p">)),</span>        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">antibody_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">antibody_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">corr_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PGT151
MAP fold change correlation: 0.813
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-6528d132caee4cafa9c572085097b541"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6528d132caee4cafa9c572085097b541") {
      outputDiv = document.getElementById("altair-viz-6528d132caee4cafa9c572085097b541");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-5b48bd2eb25c31aa4eafcbb2ae91f151"}, "mark": {"type": "circle", "filled": true, "opacity": 0.6, "size": 60}, "encoding": {"color": {"field": "max % neutralization", "scale": {"scheme": "yelloworangered"}, "title": "max % neutralization", "type": "quantitative"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "measured IC50 mutant", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC50 mutant", "format": ".3g", "type": "quantitative"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "measured IC50 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC50 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "measured_fold_change", "format": ".3g", "type": "quantitative"}, {"field": "predicted_fold_change", "format": ".3g", "type": "quantitative"}], "x": {"field": "measured_fold_change", "scale": {"domain": [0.4, 20], "type": "log"}, "title": "measured fold change IC50", "type": "quantitative"}, "y": {"field": "predicted_fold_change", "scale": {"domain": [0.4, 50], "type": "log"}, "type": "quantitative"}}, "height": 150, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-5b48bd2eb25c31aa4eafcbb2ae91f151": [{"antibody": "PGT151", "aa_substitutions": "E647G", "measured IC50 mutant": 0.114, "MAP_fold_enrichment": 5.3, "predicted IC50 mutant": 0.5309527265954268, "max % neutralization": 74, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.7538461538461538, "predicted_fold_change": 4.050010636736031}, {"antibody": "PGT151", "aa_substitutions": "E648A", "measured IC50 mutant": 0.061, "MAP_fold_enrichment": 1.2, "predicted IC50 mutant": 0.13225716218819142, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.9384615384615385, "predicted_fold_change": 1.0088335303998632}, {"antibody": "PGT151", "aa_substitutions": "E648D", "measured IC50 mutant": 0.072, "MAP_fold_enrichment": 0.7, "predicted IC50 mutant": 0.12981774852368913, "max % neutralization": 98, "times_seen": 10.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.1076923076923075, "predicted_fold_change": 0.9902261275299622}, {"antibody": "PGT151", "aa_substitutions": "E648H", "measured IC50 mutant": 0.07, "MAP_fold_enrichment": 1.5, "predicted IC50 mutant": 0.20271880060498693, "max % neutralization": 100, "times_seen": 4.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.076923076923077, "predicted_fold_change": 1.5463020671935641}, {"antibody": "PGT151", "aa_substitutions": "E648K", "measured IC50 mutant": 0.731695719, "MAP_fold_enrichment": 7.7, "predicted IC50 mutant": 3.841115478091802, "max % neutralization": 74, "times_seen": 9.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 11.256857215384615, "predicted_fold_change": 29.299328855423564}, {"antibody": "PGT151", "aa_substitutions": "E648R", "measured IC50 mutant": 0.584, "MAP_fold_enrichment": 3.7, "predicted IC50 mutant": 1.1234128067939462, "max % neutralization": 100, "times_seen": 3.3333333333333335, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 8.984615384615383, "predicted_fold_change": 8.569188157551032}, {"antibody": "PGT151", "aa_substitutions": "I641A", "measured IC50 mutant": 0.095, "MAP_fold_enrichment": 1.4, "predicted IC50 mutant": 0.1358151824246827, "max % neutralization": 100, "times_seen": 6.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4615384615384615, "predicted_fold_change": 1.0359734603441195}, {"antibody": "PGT151", "aa_substitutions": "I641E", "measured IC50 mutant": 0.099, "MAP_fold_enrichment": 1.2, "predicted IC50 mutant": 0.13097626246435232, "max % neutralization": 98, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.523076923076923, "predicted_fold_change": 0.9990630607397771}, {"antibody": "PGT151", "aa_substitutions": "I641K", "measured IC50 mutant": 0.43, "MAP_fold_enrichment": 5.7, "predicted IC50 mutant": 1.7157224727537213, "max % neutralization": 91, "times_seen": 11.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 6.615384615384615, "predicted_fold_change": 13.08721834596464}, {"antibody": "PGT151", "aa_substitutions": "I641R", "measured IC50 mutant": 0.173, "MAP_fold_enrichment": 3.2, "predicted IC50 mutant": 0.1418626044267341, "max % neutralization": 92, "times_seen": 2.6666666666666665, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 2.6615384615384614, "predicted_fold_change": 1.0821020932832286}, {"antibody": "PGT151", "aa_substitutions": "L645A", "measured IC50 mutant": 0.128, "MAP_fold_enrichment": 0.7, "predicted IC50 mutant": 0.14266030039583172, "max % neutralization": 96, "times_seen": 1.0, "frac_models": 0.6666666666666666, "n_models": 2, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.9692307692307691, "predicted_fold_change": 1.0881867727620262}, {"antibody": "PGT151", "aa_substitutions": "L645K", "measured IC50 mutant": 0.466, "MAP_fold_enrichment": 3.8, "predicted IC50 mutant": 1.9258593313311503, "max % neutralization": 90, "times_seen": 10.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 7.1692307692307695, "predicted_fold_change": 14.690104007492408}, {"antibody": "PGT151", "aa_substitutions": "L645R", "measured IC50 mutant": 0.214, "MAP_fold_enrichment": 3.7, "predicted IC50 mutant": 0.13769802832905456, "max % neutralization": 93, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 3.292307692307692, "predicted_fold_change": 1.050335465769607}, {"antibody": "PGT151", "aa_substitutions": "N611S", "measured IC50 mutant": 0.187, "MAP_fold_enrichment": 5.4, "predicted IC50 mutant": 0.5134628072788332, "max % neutralization": 98, "times_seen": 3.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 2.876923076923077, "predicted_fold_change": 3.916600719581895}, {"antibody": "PGT151", "aa_substitutions": "N637A", "measured IC50 mutant": 0.046, "MAP_fold_enrichment": 1.0, "predicted IC50 mutant": 0.1309300901646724, "max % neutralization": 81, "times_seen": 1.3333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7076923076923076, "predicted_fold_change": 0.9987108668523377}, {"antibody": "PGT151", "aa_substitutions": "N637G", "measured IC50 mutant": 0.049, "MAP_fold_enrichment": 2.8, "predicted IC50 mutant": 0.1309921828913152, "max % neutralization": 80, "times_seen": 1.6666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7538461538461538, "predicted_fold_change": 0.9991844988552842}, {"antibody": "PGT151", "aa_substitutions": "N637K", "measured IC50 mutant": 0.092, "MAP_fold_enrichment": 3.7, "predicted IC50 mutant": 0.44872909828349994, "max % neutralization": 59, "times_seen": 9.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4153846153846152, "predicted_fold_change": 3.4228237845474436}, {"antibody": "PGT151", "aa_substitutions": "Q640R", "measured IC50 mutant": 0.092, "MAP_fold_enrichment": 2.6, "predicted IC50 mutant": 0.22306084707377222, "max % neutralization": 98, "times_seen": 16.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4153846153846152, "predicted_fold_change": 1.7014674904880844}, {"antibody": "PGT151", "aa_substitutions": "S612P", "measured IC50 mutant": 0.15, "MAP_fold_enrichment": 8.0, "predicted IC50 mutant": 0.7095918319916776, "max % neutralization": 81, "times_seen": 2.3333333333333335, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 2.3076923076923075, "predicted_fold_change": 5.412637177202236}, {"antibody": "PGT151", "aa_substitutions": "T639A", "measured IC50 mutant": 0.049, "MAP_fold_enrichment": 1.4, "predicted IC50 mutant": 0.1335279657483853, "max % neutralization": 78, "times_seen": 9.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7538461538461538, "predicted_fold_change": 1.0185269883636057}, {"antibody": "PGT151", "aa_substitutions": "T639K", "measured IC50 mutant": 0.041, "MAP_fold_enrichment": 4.8, "predicted IC50 mutant": 0.2843250001992073, "max % neutralization": 74, "times_seen": 8.333333333333334, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.6307692307692307, "predicted_fold_change": 2.168779285644754}, {"antibody": "PGT151", "aa_substitutions": "T639R", "measured IC50 mutant": 0.042, "MAP_fold_enrichment": 2.8, "predicted IC50 mutant": 0.13341649302344424, "max % neutralization": 79, "times_seen": 4.333333333333333, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.6461538461538462, "predicted_fold_change": 1.0176766947327356}, {"antibody": "PGT151", "aa_substitutions": "T644A", "measured IC50 mutant": 0.052, "MAP_fold_enrichment": 1.0, "predicted IC50 mutant": 0.12509522182723598, "max % neutralization": 96, "times_seen": 8.666666666666666, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 0.7999999999999999, "predicted_fold_change": 0.9542035545307677}, {"antibody": "PGT151", "aa_substitutions": "T644R", "measured IC50 mutant": 0.094, "MAP_fold_enrichment": 4.0, "predicted IC50 mutant": 0.3182981140725838, "max % neutralization": 87, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC50 unmutated": 0.065, "predicted IC50 unmutated": 0.13109909435283115, "measured_fold_change": 1.4461538461538461, "predicted_fold_change": 2.4279200069524354}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># figure for paper</span>
<span class="n">figure_palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#999999&#39;</span><span class="p">,</span> <span class="s1">&#39;#0072B2&#39;</span><span class="p">,</span>  <span class="s1">&#39;#E69F00&#39;</span><span class="p">,</span> <span class="s1">&#39;#F0E442&#39;</span><span class="p">,</span> <span class="s1">&#39;#009E73&#39;</span><span class="p">,</span><span class="s1">&#39;#56B4E9&#39;</span><span class="p">,</span> <span class="s2">&quot;#D55E00&quot;</span><span class="p">,</span> <span class="s2">&quot;#CC79A7&quot;</span><span class="p">,</span> <span class="s1">&#39;#9F0162&#39;</span><span class="p">]</span>


<span class="n">plot_data</span> <span class="o">=</span> <span class="n">fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody not in [&quot;PGT151&quot;, &quot;1-18&quot;, &quot;3BNC117&quot;]&#39;</span><span class="p">)</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="o">~</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;aa_substitutions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">antibody</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;antibody&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;antibody==@antibody&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted fold change correlation (R): </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fold_change_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">&quot;measured_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Amino acid substitutions&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">figure_palette</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">plot_data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">strokeWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">125</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">fold_change_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
IDC508:
Predicted fold change correlation (R): 0.828
IDC513:
Predicted fold change correlation (R): 0.818
IDC561:
Predicted fold change correlation (R): 0.554
IDF033:
Predicted fold change correlation (R): 0.906
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-38380764eae14309974b7bbf7f854e52"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-38380764eae14309974b7bbf7f854e52") {
      outputDiv = document.getElementById("altair-viz-38380764eae14309974b7bbf7f854e52");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-4bcf23bb8fc94d9e4ae1585ca0e9845f"}, "mark": {"type": "circle", "filled": true, "opacity": 1, "size": 100, "stroke": "black", "strokeWidth": 1}, "encoding": {"color": {"field": "aa_substitutions", "scale": {"range": ["#999999", "#0072B2", "#E69F00", "#F0E442", "#009E73", "#56B4E9", "#D55E00", "#CC79A7", "#9F0162"]}, "title": "Amino acid substitutions", "type": "nominal"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "measured IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "type": "nominal"}, {"field": "predicted IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "measured IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "measured_fold_change", "format": ".3g", "type": "quantitative"}, {"field": "predicted_fold_change", "format": ".3g", "type": "quantitative"}], "x": {"axis": {"tickCount": 3}, "field": "measured_fold_change", "scale": {"nice": false, "type": "log"}, "title": null, "type": "quantitative"}, "y": {"axis": {"tickCount": 4}, "field": "predicted_fold_change", "scale": {"nice": false, "type": "log"}, "title": null, "type": "quantitative"}}, "height": 125, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 125, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-4bcf23bb8fc94d9e4ae1585ca0e9845f": [{"antibody": "IDC508", "aa_substitutions": "", "measured IC80 mutant": 0.07265, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.574819794642863, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC508", "aa_substitutions": "G459D", "measured IC80 mutant": 0.170428, "MAP_fold_enrichment": "", "predicted IC80 mutant": 2.4518566475093877, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.3458774948382652, "predicted_fold_change": 4.26543530748229}, {"antibody": "IDC508", "aa_substitutions": "G471H", "measured IC80 mutant": 0.117778, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7858224978140438, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.6211699931176873, "predicted_fold_change": 1.3670762648357948}, {"antibody": "IDC508", "aa_substitutions": "N276D", "measured IC80 mutant": 0.064032, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9453998171192464, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 0.8813764624913971, "predicted_fold_change": 1.644689041557147}, {"antibody": "IDC508", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.048293, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6762993404234815, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 0.664735030970406, "predicted_fold_change": 1.1765414947891069}, {"antibody": "IDC508", "aa_substitutions": "T198D", "measured IC80 mutant": 0.093518, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.8802989698770515, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.2872401927047488, "predicted_fold_change": 1.5314346828017351}, {"antibody": "IDC508", "aa_substitutions": "T202P", "measured IC80 mutant": 0.107096, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9796174062156664, "max % neutralization": 100, "times_seen": 9.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.4741362697866482, "predicted_fold_change": 1.7042165481171454}, {"antibody": "IDC508", "aa_substitutions": "V164F", "measured IC80 mutant": 0.105335, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9731564469639715, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.4498967653131452, "predicted_fold_change": 1.6929765746299603}, {"antibody": "IDC513", "aa_substitutions": "", "measured IC80 mutant": 0.816196, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.6156216539004324, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC513", "aa_substitutions": "G459D", "measured IC80 mutant": 1.691372, "MAP_fold_enrichment": "", "predicted IC80 mutant": 49.254173822635664, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 2.0722620547025468, "predicted_fold_change": 13.622601736965931}, {"antibody": "IDC513", "aa_substitutions": "G471H", "measured IC80 mutant": 1.54409, "MAP_fold_enrichment": "", "predicted IC80 mutant": 20.795167798062387, "max % neutralization": 100, "times_seen": 7.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.8918127508588622, "predicted_fold_change": 5.751477833868247}, {"antibody": "IDC513", "aa_substitutions": "N276D", "measured IC80 mutant": 0.146852, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.7448562899628977, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.17992246960288952, "predicted_fold_change": 0.4825881845465205}, {"antibody": "IDC513", "aa_substitutions": "N463S", "measured IC80 mutant": 0.579124, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.112414891063751, "max % neutralization": 100, "times_seen": 3.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.7095403555028449, "predicted_fold_change": 1.4139794979788938}, {"antibody": "IDC513", "aa_substitutions": "Q203P", "measured IC80 mutant": 0.454112, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.029473869106098, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.5563761645487113, "predicted_fold_change": 1.1144622570669729}, {"antibody": "IDC513", "aa_substitutions": "T198D", "measured IC80 mutant": 0.949675, "MAP_fold_enrichment": "", "predicted IC80 mutant": 7.905837472380779, "max % neutralization": 100, "times_seen": 6.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.1635379247141617, "predicted_fold_change": 2.186577642561738}, {"antibody": "IDC513", "aa_substitutions": "T202P", "measured IC80 mutant": 0.828638, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.160574426404362, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.0152438874976109, "predicted_fold_change": 1.4272993472193856}, {"antibody": "IDC513", "aa_substitutions": "V164F", "measured IC80 mutant": 0.969812, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.859881578268904, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.1882096947301872, "predicted_fold_change": 1.344134437580381}, {"antibody": "IDC561", "aa_substitutions": "", "measured IC80 mutant": 0.153056, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3329244098737939, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC561", "aa_substitutions": "G459D", "measured IC80 mutant": 0.048589, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.32820466406650095, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.31745896926615097, "predicted_fold_change": 0.98582337110973}, {"antibody": "IDC561", "aa_substitutions": "G471H", "measured IC80 mutant": 0.200952, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.46605891395216875, "max % neutralization": 100, "times_seen": 7.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.3129312147187957, "predicted_fold_change": 1.3998940904598853}, {"antibody": "IDC561", "aa_substitutions": "N276D", "measured IC80 mutant": 0.028087, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3108368110838055, "max % neutralization": 100, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.18350799707296678, "predicted_fold_change": 0.9336558145485294}, {"antibody": "IDC561", "aa_substitutions": "T198D", "measured IC80 mutant": 0.203756, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1633897927193964, "max % neutralization": 100, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.331251306711269, "predicted_fold_change": 3.4944562736040234}, {"antibody": "IDC561", "aa_substitutions": "V164F", "measured IC80 mutant": 0.134386, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.0084274552578132, "max % neutralization": 100, "times_seen": 4.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.8780185030315701, "predicted_fold_change": 3.0289982511047815}, {"antibody": "IDF033", "aa_substitutions": "", "measured IC80 mutant": 0.13461, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6367780571913589, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDF033", "aa_substitutions": "G459D", "measured IC80 mutant": 0.241945, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.9200757519740765, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.7973776093900897, "predicted_fold_change": 6.156109978513361}, {"antibody": "IDF033", "aa_substitutions": "G471H", "measured IC80 mutant": 0.207215, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.7591955619153541, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.5393730034915682, "predicted_fold_change": 1.1922451682206872}, {"antibody": "IDF033", "aa_substitutions": "N276D", "measured IC80 mutant": 0.399994, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.992028933853504, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 2.9715028601144047, "predicted_fold_change": 7.839511549552882}, {"antibody": "IDF033", "aa_substitutions": "N463S", "measured IC80 mutant": 0.160264, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.4082148344729937, "max % neutralization": 100, "times_seen": 3.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.1905801946363568, "predicted_fold_change": 2.211468844708965}, {"antibody": "IDF033", "aa_substitutions": "T198D", "measured IC80 mutant": 0.115156, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6459743906901667, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 0.8554787905801946, "predicted_fold_change": 1.0144419761248842}, {"antibody": "IDF033", "aa_substitutions": "V164F", "measured IC80 mutant": 0.145081, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6739889970878276, "max % neutralization": 100, "times_seen": 3.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.0777876829358888, "predicted_fold_change": 1.0584362785058818}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">fold_changes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody not in [&quot;PGT151&quot;, &quot;1-18&quot;, &quot;3BNC117&quot;]&#39;</span><span class="p">)</span>
<span class="n">virus_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;T198D&quot;</span><span class="p">,</span>
              <span class="s2">&quot;N276D&quot;</span><span class="p">,</span>
              <span class="s2">&quot;G459D&quot;</span><span class="p">,</span>
              <span class="s2">&quot;T198D N276D&quot;</span><span class="p">,</span>
              <span class="s2">&quot;T198D G459D&quot;</span><span class="p">,</span>
              <span class="s2">&quot;N276D G459D&quot;</span><span class="p">,</span>
              <span class="s2">&quot;T198D N276D G459D&quot;</span><span class="p">]</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;aa_substitutions in @virus_list&#39;</span><span class="p">)</span>

<span class="n">figure_palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#999999&#39;</span><span class="p">,</span> <span class="s1">&#39;#0072B2&#39;</span><span class="p">,</span>  <span class="s1">&#39;#F0E442&#39;</span><span class="p">,</span> <span class="s1">&#39;#E69F00&#39;</span><span class="p">,</span> <span class="s2">&quot;#D55E00&quot;</span><span class="p">,</span> <span class="s1">&#39;#009E73&#39;</span><span class="p">,</span> <span class="s1">&#39;#56B4E9&#39;</span><span class="p">,</span>  <span class="s2">&quot;#CC79A7&quot;</span><span class="p">,</span> <span class="s1">&#39;#9F0162&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">antibody</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;antibody&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">antibody_df</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;antibody==@antibody&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">antibody</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="n">antibody_df</span><span class="p">[</span><span class="s2">&quot;measured_fold_change&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted fold change correlation (R): </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fold_change_chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;frac_models&gt;=.5&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">&quot;measured_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">&quot;predicted_fold_change&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">nice</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickCount</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">facet</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Facet</span><span class="p">(</span><span class="s2">&quot;antibody&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;aa_substitutions&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Amino acid substitutions&quot;</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">figure_palette</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">plot_data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span>
            <span class="k">else</span> <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">strokeWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">resolve_scale</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">125</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">fold_change_chart</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
IDC508:
Predicted fold change correlation (R): 0.889
IDC513:
Predicted fold change correlation (R): 0.707
IDC561:
Predicted fold change correlation (R): 0.234
IDF033:
Predicted fold change correlation (R): 0.858
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div id="altair-viz-07e159904ff140c4b83212ca17d79a15"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-07e159904ff140c4b83212ca17d79a15") {
      outputDiv = document.getElementById("altair-viz-07e159904ff140c4b83212ca17d79a15");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"grid": false}}, "data": {"name": "data-9ecd7fd4daa5b0c8c96b8a5eb0198c37"}, "mark": {"type": "circle", "filled": true, "opacity": 1, "size": 100, "stroke": "black", "strokeWidth": 1}, "encoding": {"color": {"field": "aa_substitutions", "scale": {"range": ["#999999", "#0072B2", "#F0E442", "#E69F00", "#D55E00", "#009E73", "#56B4E9", "#CC79A7", "#9F0162"]}, "title": "Amino acid substitutions", "type": "nominal"}, "facet": {"columns": 4, "field": "antibody", "title": null, "type": "nominal"}, "tooltip": [{"field": "antibody", "type": "nominal"}, {"field": "aa_substitutions", "type": "nominal"}, {"field": "measured IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "MAP_fold_enrichment", "type": "nominal"}, {"field": "predicted IC80 mutant", "format": ".3g", "type": "quantitative"}, {"field": "max % neutralization", "type": "quantitative"}, {"field": "times_seen", "format": ".3g", "type": "quantitative"}, {"field": "frac_models", "format": ".3g", "type": "quantitative"}, {"field": "n_models", "type": "quantitative"}, {"field": "measured IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "predicted IC80 unmutated", "format": ".3g", "type": "quantitative"}, {"field": "measured_fold_change", "format": ".3g", "type": "quantitative"}, {"field": "predicted_fold_change", "format": ".3g", "type": "quantitative"}], "x": {"axis": {"tickCount": 3}, "field": "measured_fold_change", "scale": {"nice": false, "type": "log"}, "title": null, "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "predicted_fold_change", "scale": {"nice": false, "type": "log"}, "title": null, "type": "quantitative"}}, "height": 125, "resolve": {"scale": {"x": "independent", "y": "independent"}}, "width": 125, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-9ecd7fd4daa5b0c8c96b8a5eb0198c37": [{"antibody": "IDC508", "aa_substitutions": "", "measured IC80 mutant": 0.07265, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.574819794642863, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC508", "aa_substitutions": "G459D", "measured IC80 mutant": 0.170428, "MAP_fold_enrichment": "", "predicted IC80 mutant": 2.4518566475093877, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.3458774948382652, "predicted_fold_change": 4.26543530748229}, {"antibody": "IDC508", "aa_substitutions": "N276D", "measured IC80 mutant": 0.064032, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.9453998171192464, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 0.8813764624913971, "predicted_fold_change": 1.644689041557147}, {"antibody": "IDC508", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.143642, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.070767431369208, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.9771782518926357, "predicted_fold_change": 7.0818149780286985}, {"antibody": "IDC508", "aa_substitutions": "T198D", "measured IC80 mutant": 0.093518, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.8802989698770515, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 1.2872401927047488, "predicted_fold_change": 1.5314346828017351}, {"antibody": "IDC508", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 0.199289, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.8184239927175776, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.7431383344803852, "predicted_fold_change": 6.6428192423157135}, {"antibody": "IDC508", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.177027, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.4938647670016216, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 2.4367102546455603, "predicted_fold_change": 2.598840159862211}, {"antibody": "IDC508", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.309676, "MAP_fold_enrichment": "", "predicted IC80 mutant": 6.526955520276452, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.07265, "predicted IC80 unmutated": 0.574819794642863, "measured_fold_change": 4.262573984858912, "predicted_fold_change": 11.35478558864116}, {"antibody": "IDC513", "aa_substitutions": "", "measured IC80 mutant": 0.816196, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.6156216539004324, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC513", "aa_substitutions": "G459D", "measured IC80 mutant": 1.691372, "MAP_fold_enrichment": "", "predicted IC80 mutant": 49.254173822635664, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 2.0722620547025468, "predicted_fold_change": 13.622601736965931}, {"antibody": "IDC513", "aa_substitutions": "N276D", "measured IC80 mutant": 0.146852, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.7448562899628977, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.17992246960288952, "predicted_fold_change": 0.4825881845465205}, {"antibody": "IDC513", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.708088, "MAP_fold_enrichment": "", "predicted IC80 mutant": 24.70852940350781, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.8675465206886581, "predicted_fold_change": 6.833826038422171}, {"antibody": "IDC513", "aa_substitutions": "T198D", "measured IC80 mutant": 0.949675, "MAP_fold_enrichment": "", "predicted IC80 mutant": 7.905837472380779, "max % neutralization": 100, "times_seen": 6.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.1635379247141617, "predicted_fold_change": 2.186577642561738}, {"antibody": "IDC513", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 1.351345, "MAP_fold_enrichment": "", "predicted IC80 mutant": 104.50256517363665, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.6556623654122293, "predicted_fold_change": 28.90306983887603}, {"antibody": "IDC513", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.228646, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.416778129667989, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 0.2801361437693887, "predicted_fold_change": 0.945004333067334}, {"antibody": "IDC513", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.990427, "MAP_fold_enrichment": "", "predicted IC80 mutant": 46.40531808467982, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.816196, "predicted IC80 unmutated": 3.6156216539004324, "measured_fold_change": 1.2134671083906317, "predicted_fold_change": 12.834672022339243}, {"antibody": "IDC561", "aa_substitutions": "", "measured IC80 mutant": 0.153056, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3329244098737939, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDC561", "aa_substitutions": "G459D", "measured IC80 mutant": 0.048589, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.32820466406650095, "max % neutralization": 100, "times_seen": 8.0, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.31745896926615097, "predicted_fold_change": 0.98582337110973}, {"antibody": "IDC561", "aa_substitutions": "N276D", "measured IC80 mutant": 0.028087, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3108368110838055, "max % neutralization": 100, "times_seen": 5.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.18350799707296678, "predicted_fold_change": 0.9336558145485294}, {"antibody": "IDC561", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.019897, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.3064301929676354, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.1299981706042233, "predicted_fold_change": 0.920419722554432}, {"antibody": "IDC561", "aa_substitutions": "T198D", "measured IC80 mutant": 0.203756, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1633897927193964, "max % neutralization": 100, "times_seen": 4.666666666666667, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 1.331251306711269, "predicted_fold_change": 3.4944562736040234}, {"antibody": "IDC561", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 0.060962, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1585586886489407, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.3982986619276605, "predicted_fold_change": 3.4799451595878206}, {"antibody": "IDC561", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.065299, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1316525713510242, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.42663469579761654, "predicted_fold_change": 3.3991276631834078}, {"antibody": "IDC561", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.024444, "MAP_fold_enrichment": "", "predicted IC80 mutant": 1.1269532595829397, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 3, "measured IC80 unmutated": 0.153056, "predicted IC80 unmutated": 0.3329244098737939, "measured_fold_change": 0.15970625130671126, "predicted_fold_change": 3.3850124117067564}, {"antibody": "IDF033", "aa_substitutions": "", "measured IC80 mutant": 0.13461, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6367780571913589, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.0, "predicted_fold_change": 1.0}, {"antibody": "IDF033", "aa_substitutions": "G459D", "measured IC80 mutant": 0.241945, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.9200757519740765, "max % neutralization": 100, "times_seen": 8.5, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.7973776093900897, "predicted_fold_change": 6.156109978513361}, {"antibody": "IDF033", "aa_substitutions": "N276D", "measured IC80 mutant": 0.399994, "MAP_fold_enrichment": "", "predicted IC80 mutant": 4.992028933853504, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 2.9715028601144047, "predicted_fold_change": 7.839511549552882}, {"antibody": "IDF033", "aa_substitutions": "N276D G459D", "measured IC80 mutant": 0.491114, "MAP_fold_enrichment": "", "predicted IC80 mutant": 31.860902060651135, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 3.6484213654260453, "predicted_fold_change": 50.03454767455433}, {"antibody": "IDF033", "aa_substitutions": "T198D", "measured IC80 mutant": 0.115156, "MAP_fold_enrichment": "", "predicted IC80 mutant": 0.6459743906901667, "max % neutralization": 100, "times_seen": 6.0, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 0.8554787905801946, "predicted_fold_change": 1.0144419761248842}, {"antibody": "IDF033", "aa_substitutions": "T198D G459D", "measured IC80 mutant": 0.213871, "MAP_fold_enrichment": "", "predicted IC80 mutant": 3.9664348153602544, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 1.5888195527821112, "predicted_fold_change": 6.228912523862763}, {"antibody": "IDF033", "aa_substitutions": "T198D N276D", "measured IC80 mutant": 0.395863, "MAP_fold_enrichment": "", "predicted IC80 mutant": 5.032610654892533, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 2.940814203996731, "predicted_fold_change": 7.903241322557347}, {"antibody": "IDF033", "aa_substitutions": "T198D N276D G459D", "measured IC80 mutant": 0.687717, "MAP_fold_enrichment": "", "predicted IC80 mutant": 32.038219878164696, "max % neutralization": 100, "times_seen": null, "frac_models": 1.0, "n_models": 2, "measured IC80 unmutated": 0.13461, "predicted IC80 unmutated": 0.6367780571913589, "measured_fold_change": 5.108959215511478, "predicted_fold_change": 50.31300861633939}]}}, {"mode": "vega-lite"});
</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


          </div>
          
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Caelan Radford, Jesse Bloom, et al. (2023).
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/validation_ICs.nblink.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>